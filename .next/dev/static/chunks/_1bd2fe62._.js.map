{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\nimport { Loader2 } from 'lucide-react'\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 ease-out active:scale-95 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  loading,\n  children,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n    loading?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }), loading ? 'cursor-wait' : '')}\n      aria-busy={loading ? true : undefined}\n      disabled={(props as any)?.disabled || !!loading}\n      {...props}\n    >\n      {loading ? (\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\n      ) : null}\n      {children}\n    </Comp>\n  )\n}\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,qeACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,OAAO,EACP,QAAQ,EACR,GAAG,OAKF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU,IAAI,UAAU,gBAAgB;QACtF,aAAW,UAAU,OAAO;QAC5B,UAAU,AAAC,OAAe,YAAY,CAAC,CAAC;QACvC,GAAG,KAAK;;YAER,wBACC,6LAAC,+NAAO;gBAAC,WAAU;;;;;uBACjB;YACH;;;;;;;AAGP;KA7BS"}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/chat-bubble.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef, memo } from 'react'\nimport { createPortal } from 'react-dom'\nimport { Copy, Share2, Trash2, MoreVertical, Image as ImageIcon, SmilePlus, Reply, Check } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\n\ninterface ChatBubbleProps {\n  message: string\n  sender: string\n  avatar: string\n  showAvatar?: boolean\n  isOwn?: boolean\n  timestamp?: string\n  reactions?: { emoji: string; count: number }[]\n  messageId?: string\n  onDelete?: (messageId: string) => void\n  mediaUrl?: string\n  mediaType?: string\n  onReaction?: (emoji: string) => void\n  onReply?: (message: Message) => void\n  selectionMode?: boolean\n  isSelected?: boolean\n  onSelect?: () => void\n}\n\ninterface Message {\n  id: string\n  content: string\n  sender: string\n  // ... other fields\n}\n\nfunction ChatBubbleComponent({\n  message,\n  sender,\n  avatar,\n  showAvatar = true,\n  isOwn = false,\n  timestamp,\n  reactions = [],\n  messageId,\n  onDelete,\n  mediaUrl,\n  mediaType,\n  onReaction,\n  onReply,\n  selectionMode = false,\n  isSelected = false,\n  onSelect,\n}: ChatBubbleProps) {\n  const [showMenu, setShowMenu] = useState(false)\n  const [isHovered, setIsHovered] = useState(false)\n  const [copyFeedback, setCopyFeedback] = useState(false)\n  const [menuUp, setMenuUp] = useState(false)\n  const [menuLeft, setMenuLeft] = useState(0)\n  const [menuTop, setMenuTop] = useState(0)\n  const anchorRectRef = useRef<DOMRect | null>(null)\n  const menuRef = useRef<HTMLDivElement | null>(null)\n\n  const handleCopy = () => {\n    if (navigator.clipboard && navigator.clipboard.writeText) {\n      navigator.clipboard.writeText(message).then(() => {\n        setCopyFeedback(true)\n        setTimeout(() => setCopyFeedback(false), 2000)\n      }).catch(console.error)\n    } else {\n      // Fallback\n      const textArea = document.createElement(\"textarea\")\n      textArea.value = message\n      document.body.appendChild(textArea)\n      textArea.select()\n      try {\n        document.execCommand('copy')\n        setCopyFeedback(true)\n        setTimeout(() => setCopyFeedback(false), 2000)\n      } catch (err) {\n        console.error('Fallback: Oops, unable to copy', err)\n      }\n      document.body.removeChild(textArea)\n    }\n    setShowMenu(false)\n  }\n\n  const handleShare = async () => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: `Message from ${sender}`,\n          text: message,\n        })\n        setShowMenu(false)\n      } catch (err) {\n        // User cancelled or error - fallback to copy\n        handleCopy()\n      }\n    } else {\n      handleCopy()\n    }\n  }\n\n  const handleDelete = () => {\n    if (messageId && onDelete) {\n      onDelete(messageId)\n      setShowMenu(false)\n    }\n  }\n\n  useEffect(() => {\n    if (showMenu && menuUp && anchorRectRef.current && menuRef.current) {\n      const h = menuRef.current.getBoundingClientRect().height\n      const top = anchorRectRef.current.top - 8 - h\n      setMenuTop(Math.max(8, top))\n    }\n  }, [showMenu, menuUp])\n\n  return (\n    <div\n      className={`flex gap-1.5 sm:gap-3 mb-2 sm:mb-4 group ${isOwn ? 'flex-row-reverse' : ''}`}\n      style={{ contentVisibility: 'auto', containIntrinsicSize: '160px' }}\n      data-message-id={messageId}\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n    >\n      {selectionMode ? (\n        <div className=\"flex items-center justify-center w-8 sm:w-10\">\n          <div\n            className={`w-5 h-5 rounded border flex items-center justify-center cursor-pointer transition-colors ${isSelected ? 'bg-primary border-primary text-primary-foreground' : 'border-foreground/30 hover:border-primary'}`}\n            onClick={(e) => {\n              e.stopPropagation()\n              onSelect?.()\n            }}\n          >\n            {isSelected && <Check className=\"w-3.5 h-3.5\" />}\n          </div>\n        </div>\n      ) : (\n        showAvatar && (\n          <img\n            src={avatar || \"/placeholder.svg\"}\n            alt={sender}\n            className=\"w-8 h-8 sm:w-10 sm:h-10 rounded-full flex-shrink-0\"\n          />\n        )\n      )}\n      <div className={`flex flex-col ${isOwn ? 'items-end' : 'items-start'} flex-1 min-w-0`}>\n        <p className=\"text-[10px] sm:text-xs text-foreground/50 px-1.5 sm:px-3 mb-0.5 sm:mb-1\">{sender}</p>\n        <div\n          className={`relative max-w-[85%] sm:max-w-xs md:max-w-md px-3 sm:px-4 py-2 sm:py-3 rounded-2xl sm:rounded-3xl cursor-pointer active:scale-[0.98] transition-transform ${isOwn\n            ? 'bg-primary text-primary-foreground rounded-br-sm'\n            : 'bg-secondary text-secondary-foreground rounded-bl-sm'\n            }`}\n          onClick={(e) => {\n            e.stopPropagation()\n            try {\n              const rect = (e.currentTarget as HTMLElement).getBoundingClientRect()\n              anchorRectRef.current = rect\n              const spaceBelow = window.innerHeight - rect.bottom\n              setMenuUp(spaceBelow < 160)\n              const left = Math.min(Math.max(8, rect.left), window.innerWidth - 168)\n              const top = rect.bottom + 8\n              setMenuLeft(left)\n              setMenuTop(top)\n            } catch { }\n            if (!selectionMode) {\n              setShowMenu((v) => !v)\n            } else {\n              onSelect?.()\n            }\n          }}\n        >\n          <p className=\"break-words text-sm sm:text-base leading-relaxed\">{message}</p>\n\n          {/* Media Display */}\n          {mediaUrl && mediaType?.startsWith('image/') && (\n            <div className=\"mt-2 rounded-lg overflow-hidden max-w-full\">\n              <img\n                src={mediaUrl}\n                alt=\"Shared image\"\n                className=\"max-w-full h-auto rounded-lg cursor-pointer\"\n                onClick={() => window.open(mediaUrl, '_blank')}\n              />\n            </div>\n          )}\n          {mediaUrl && !mediaType?.startsWith('image/') && (\n            <div className=\"mt-2\">\n              <a\n                href={mediaUrl}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-xs sm:text-sm text-primary hover:underline flex items-center gap-1\"\n              >\n                <ImageIcon className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n                View attachment\n              </a>\n            </div>\n          )}\n\n\n          {/* PC Hover Actions */}\n          {!selectionMode && isHovered && (\n            <div className={`hidden sm:flex absolute ${isOwn ? '-top-4 right-0' : '-top-4 left-0'} bg-background border border-border shadow-sm rounded-full p-0.5 gap-0.5 z-10 items-center`}>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-6 w-6 rounded-full hover:bg-accent text-foreground/70\"\n                onClick={(e) => { e.stopPropagation(); onReaction?.('üëç') }}\n                title=\"Like\"\n              >\n                <span className=\"text-xs\">üëç</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-6 w-6 rounded-full hover:bg-accent text-foreground/70\"\n                onClick={(e) => { e.stopPropagation(); onReaction?.('‚ù§Ô∏è') }}\n                title=\"Love\"\n              >\n                <span className=\"text-xs\">‚ù§Ô∏è</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-6 w-6 rounded-full hover:bg-accent text-foreground/70\"\n                onClick={(e) => { e.stopPropagation(); onReaction?.('üòÇ') }}\n                title=\"Laugh\"\n              >\n                <span className=\"text-xs\">üòÇ</span>\n              </Button>\n              {onReply && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-6 w-6 rounded-full hover:bg-accent text-foreground/70\"\n                  onClick={(e) => { e.stopPropagation(); onReply({ id: messageId || '', content: message, sender } as any) }}\n                >\n                  <Reply className=\"w-3 h-3\" />\n                </Button>\n              )}\n              {isOwn && onDelete && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-6 w-6 rounded-full hover:bg-destructive/10 text-destructive/70 hover:text-destructive\"\n                  onClick={(e) => { e.stopPropagation(); onDelete(messageId || '') }}\n                >\n                  <Trash2 className=\"w-3 h-3\" />\n                </Button>\n              )}\n            </div>\n          )}\n\n          {/* Menu Dropdown */}\n          {showMenu && createPortal((\n            <>\n              <div\n                className=\"fixed inset-0 z-[60] bg-background/30 backdrop-blur-[1px]\"\n                onClick={() => setShowMenu(false)}\n              />\n              <div\n                ref={menuRef}\n                className={`fixed bg-card border border-border rounded-lg shadow-lg p-1 z-[70] min-w-[160px]`}\n                style={{ left: menuLeft, top: menuTop }}\n              >\n                <button\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    handleCopy()\n                  }}\n                  data-action=\"copy\"\n                  data-message-id={messageId}\n                  className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-accent active:bg-accent/80 rounded-md transition-colors text-foreground\"\n                >\n                  <Copy className=\"w-4 h-4\" />\n                  {copyFeedback ? 'Copied!' : 'Copy'}\n                </button>\n                <button\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    handleShare()\n                  }}\n                  data-action=\"share\"\n                  data-message-id={messageId}\n                  className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-accent active:bg-accent/80 rounded-md transition-colors text-foreground\"\n                >\n                  <Share2 className=\"w-4 h-4\" />\n                  Share\n                </button>\n                {isOwn && onDelete && (\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      handleDelete()\n                    }}\n                    data-action=\"delete\"\n                    data-message-id={messageId}\n                    className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-destructive/10 active:bg-destructive/20 text-destructive rounded-md transition-colors\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                    Delete\n                  </button>\n                )}\n              </div>\n            </>\n          ), document.body)}\n        </div>\n        <div className=\"flex gap-1 mt-0.5 sm:mt-2 px-1.5 sm:px-2 flex-wrap justify-center\">\n          {reactions.map((r, i) => (\n            <button\n              key={i}\n              className={`text-[10px] sm:text-xs bg-accent/20 rounded-full px-1.5 sm:px-2 py-0.5 hover:bg-accent/40 cursor-pointer transition-colors border border-transparent hover:border-border ${r.count > 0 ? '' : 'hidden'}`}\n              onClick={(e) => {\n                e.stopPropagation()\n                onReaction?.(r.emoji)\n              }}\n            >\n              {r.emoji} {r.count > 1 ? r.count : ''}\n            </button>\n          ))}\n        </div>\n        {timestamp && <p className=\"text-[10px] sm:text-xs text-foreground/40 mt-0.5 sm:mt-1 px-1.5 sm:px-2\">{timestamp}</p>}\n      </div>\n    </div>\n  )\n}\n\nexport const ChatBubble = memo(ChatBubbleComponent)\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 745, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/theme-toggle.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Moon, Sun } from 'lucide-react'\r\n\r\nexport function ThemeToggle() {\r\n  const [isDark, setIsDark] = useState(false)\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    // Check system preference or stored preference\r\n    const isDarkMode = localStorage.getItem('theme') === 'dark' ||\r\n      (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)\r\n    setIsDark(isDarkMode)\r\n    if (isDarkMode) {\r\n      document.documentElement.classList.add('dark')\r\n    }\r\n  }, [])\r\n\r\n  const toggleTheme = () => {\r\n    const newIsDark = !isDark\r\n    setIsDark(newIsDark)\r\n    \r\n    if (newIsDark) {\r\n      document.documentElement.classList.add('dark')\r\n      localStorage.setItem('theme', 'dark')\r\n    } else {\r\n      document.documentElement.classList.remove('dark')\r\n      localStorage.setItem('theme', 'light')\r\n    }\r\n  }\r\n\r\n  if (!mounted) return null\r\n\r\n  return (\r\n    <Button\r\n      variant=\"ghost\"\r\n      size=\"icon\"\r\n      onClick={toggleTheme}\r\n      className=\"rounded-full hover:bg-accent/20\"\r\n    >\r\n      {isDark ? (\r\n        <Sun className=\"w-5 h-5 text-yellow-400\" />\r\n      ) : (\r\n        <Moon className=\"w-5 h-5 text-slate-600\" />\r\n      )}\r\n    </Button>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;;;AAJA;;;;AAMO,SAAS;;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;iCAAC;YACR,WAAW;YACX,+CAA+C;YAC/C,MAAM,aAAa,aAAa,OAAO,CAAC,aAAa,UAClD,CAAC,aAAa,OAAO,CAAC,YAAY,OAAO,UAAU,CAAC,gCAAgC,OAAO;YAC9F,UAAU;YACV,IAAI,YAAY;gBACd,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;YACzC;QACF;gCAAG,EAAE;IAEL,MAAM,cAAc;QAClB,MAAM,YAAY,CAAC;QACnB,UAAU;QAEV,IAAI,WAAW;YACb,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;YACvC,aAAa,OAAO,CAAC,SAAS;QAChC,OAAO;YACL,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;YAC1C,aAAa,OAAO,CAAC,SAAS;QAChC;IACF;IAEA,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,6LAAC,wIAAM;QACL,SAAQ;QACR,MAAK;QACL,SAAS;QACT,WAAU;kBAET,uBACC,6LAAC,0MAAG;YAAC,WAAU;;;;;iCAEf,6LAAC,6MAAI;YAAC,WAAU;;;;;;;;;;;AAIxB;GA5CgB;KAAA"}},
    {"offset": {"line": 822, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from \"@supabase/ssr\";\r\n\r\nexport function createClient() {\r\n  return createBrowserClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAII;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,oMAAmB;AAI5B"}},
    {"offset": {"line": 840, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/notifications-popover.tsx"],"sourcesContent":["'use client'\n\nimport * as Popover from '@radix-ui/react-popover'\nimport { useEffect, useState } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { createClient } from '@/lib/supabase/client'\nimport { Bell, Check, ArrowRight } from 'lucide-react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\n\ninterface NotificationRow {\n  id: string\n  sender_id: string | null\n  recipient_id: string\n  type: string\n  room_id?: string | null\n  friend_request_id?: string | null\n  message?: string | null\n  created_at: string\n  read_at?: string | null\n}\n\nexport function NotificationsPopover() {\n  const supabase = createClient()\n  const router = useRouter()\n  const [open, setOpen] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [items, setItems] = useState<NotificationRow[]>([])\n  const [unread, setUnread] = useState<number>(0)\n  const [senders, setSenders] = useState<Record<string, any>>({})\n  const [search, setSearch] = useState('')\n  const [actionLoadingId, setActionLoadingId] = useState<string | null>(null)\n\n  const refresh = async () => {\n    try {\n      setLoading(true)\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) {\n        setItems([])\n        setUnread(0)\n        setSenders({})\n        return\n      }\n      const { data } = await supabase\n        .from('notifications')\n        .select('*')\n        .eq('recipient_id', user.id)\n        .order('created_at', { ascending: false })\n      const rows = (data || []) as any as NotificationRow[]\n      setItems(rows)\n      setUnread(rows.filter((r) => !r.read_at).length)\n      const ids = Array.from(new Set(rows.map((r) => r.sender_id).filter((x): x is string => !!x)))\n      if (ids.length) {\n        const { data: profs } = await supabase\n          .from('profiles')\n          .select('id, username, display_name, avatar_url')\n          .in('id', ids)\n        const map: Record<string, any> = {}\n        ;(profs || []).forEach((p: any) => { map[p.id] = p })\n        setSenders(map)\n      } else {\n        setSenders({})\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    refresh()\n  }, [])\n\n  const markAllRead = async () => {\n    const ids = items.filter((i) => !i.read_at).map((i) => i.id)\n    if (!ids.length) return\n    await supabase.from('notifications').update({ read_at: new Date().toISOString() }).in('id', ids)\n    setItems((prev) => prev.map((i) => ({ ...i, read_at: i.read_at || new Date().toISOString() })))\n    setUnread(0)\n  }\n\n  const markRead = async (id: string) => {\n    const row = items.find((i) => i.id === id)\n    if (!row || row.read_at) return\n    await supabase.from('notifications').update({ read_at: new Date().toISOString() }).eq('id', id)\n    setItems((prev) => prev.map((i) => i.id === id ? { ...i, read_at: new Date().toISOString() } : i))\n    setUnread((u) => Math.max(0, u - 1))\n  }\n\n  const acceptFriendRequest = async (id: string, friend_request_id?: string | null) => {\n    if (!friend_request_id) return\n    try {\n      setActionLoadingId(id)\n      const res = await fetch('/api/friends/accept', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ friend_request_id }),\n      })\n      if (res.ok) {\n        await markRead(id)\n        setItems((prev) => prev.map((i) => i.id === id ? { ...i, type: 'friend_request_accepted' } : i))\n      }\n    } catch {}\n    finally { setActionLoadingId(null) }\n  }\n\n  const renderText = (n: NotificationRow) => {\n    const s = n.sender_id ? senders[n.sender_id] : null\n    const name = s?.display_name || s?.username || 'Someone'\n    if (n.type === 'friend_request') return `${name} sent you a friend request`\n    if (n.type === 'room_member_added') return `${name} added you to a private room`\n    return n.message || 'Notification'\n  }\n\n  const declineFriendRequest = async (id: string, friend_request_id?: string | null) => {\n    if (!friend_request_id) return\n    try {\n      setActionLoadingId(id)\n      const res = await fetch('/api/friends/decline', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ friend_request_id }),\n      })\n      if (res.ok) {\n        await markRead(id)\n        setItems((prev) => prev.map((i) => i.id === id ? { ...i, type: 'friend_request_declined' } : i))\n      }\n    } catch {}\n    finally { setActionLoadingId(null) }\n  }\n\n  return (\n    <Popover.Root open={open} onOpenChange={setOpen}>\n      <Popover.Trigger asChild>\n        <Button variant=\"outline\" size=\"icon\" className=\"rounded-full relative\" aria-label=\"Notifications\" onClick={() => { if (!open) refresh() }}>\n          <Bell className=\"w-4 h-4\" />\n          {unread > 0 && (\n            <span className=\"absolute -top-1 -right-1 px-1.5 py-0.5 rounded-full bg-destructive text-destructive-foreground text-[10px] leading-none font-bold\">\n              {unread}\n            </span>\n          )}\n        </Button>\n      </Popover.Trigger>\n      <Popover.Portal>\n        <Popover.Content sideOffset={8} align=\"end\" className=\"z-[70] w-[92vw] sm:w-80 max-w-[92vw] rounded-xl border border-border bg-card shadow-lg p-3\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"text-sm font-semibold\">Notifications</div>\n            <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" onClick={markAllRead} disabled={unread === 0}>\n              <Check className=\"w-3.5 h-3.5 mr-1\" /> Mark all read\n            </Button>\n          </div>\n          <Input placeholder=\"Search\" value={search} onChange={(e) => setSearch(e.target.value)} className=\"mb-2\" />\n          <div className=\"max-h-64 overflow-auto space-y-2 pr-1\">\n            {loading ? (\n              <div className=\"text-xs text-foreground/60\">Loading‚Ä¶</div>\n            ) : items.filter((n) => renderText(n).toLowerCase().includes(search.toLowerCase())).length === 0 ? (\n              <div className=\"text-xs text-foreground/60\">No notifications</div>\n            ) : (\n              items\n                .filter((n) => renderText(n).toLowerCase().includes(search.toLowerCase()))\n                .map((n) => {\n                  const s = n.sender_id ? senders[n.sender_id] : null\n                  const name = s?.display_name || s?.username || 'Someone'\n                  const isRequest = n.type === 'friend_request'\n                  const isAccepted = n.type === 'friend_request_accepted'\n                  const isDeclined = n.type === 'friend_request_declined'\n                  return (\n                    <div key={n.id} className={`flex items-center gap-3 p-2 border rounded-md ${n.read_at ? 'opacity-70' : ''}`}>\n                      {n.sender_id ? (\n                        <Link href={`/profile/${n.sender_id}`} className=\"flex items-center gap-2\">\n                          <img src={s?.avatar_url || '/placeholder.svg'} alt={name} className=\"w-6 h-6 rounded-full\" />\n                        </Link>\n                      ) : (\n                        <img src={s?.avatar_url || '/placeholder.svg'} alt={name} className=\"w-6 h-6 rounded-full\" />\n                      )}\n                      <div className=\"min-w-0 flex-1\">\n                        {n.sender_id ? (\n                          <Link href={`/profile/${n.sender_id}`} className=\"text-xs font-semibold truncate\" title={name}>{name}</Link>\n                        ) : (\n                          <div className=\"text-xs font-semibold truncate\" title={name}>{name}</div>\n                        )}\n                        <div className=\"text-[11px] text-foreground/70 whitespace-nowrap truncate\" title={renderText(n)}>{renderText(n)}</div>\n                      </div>\n                      {isRequest && !n.read_at ? (\n                        <div className=\"flex items-center gap-2\">\n                          <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" loading={actionLoadingId === n.id} onClick={async () => { await acceptFriendRequest(n.id, n.friend_request_id) }}>\n                            <Check className=\"w-3.5 h-3.5 mr-1\" /> Accept\n                          </Button>\n                          <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" loading={actionLoadingId === n.id} onClick={async () => { await declineFriendRequest(n.id, n.friend_request_id) }}>\n                            <ArrowRight className=\"w-3.5 h-3.5 mr-1\" /> Decline\n                          </Button>\n                        </div>\n                      ) : isAccepted ? (\n                        <div className=\"text-[11px] font-semibold text-green-600 dark:text-green-400\">Accepted</div>\n                      ) : isDeclined ? (\n                        <div className=\"text-[11px] font-semibold text-destructive\">Declined</div>\n                      ) : n.room_id ? (\n                        <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" onClick={async () => { await markRead(n.id); router.push(`/room/${n.room_id}`); setOpen(false) }}>\n                          <ArrowRight className=\"w-3.5 h-3.5\" />\n                        </Button>\n                      ) : (\n                        <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" onClick={async () => { await markRead(n.id); setOpen(false) }}>\n                          <Check className=\"w-3.5 h-3.5\" />\n                        </Button>\n                      )}\n                    </div>\n                  )\n                })\n            )}\n          </div>\n        </Popover.Content>\n      </Popover.Portal>\n    </Popover.Root>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;;;AATA;;;;;;;;;AAuBO,SAAS;;IACd,MAAM,WAAW,IAAA,4IAAY;IAC7B,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAoB,EAAE;IACxD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAS;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAsB,CAAC;IAC7D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAgB;IAEtE,MAAM,UAAU;QACd,IAAI;YACF,WAAW;YACX,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;YACtD,IAAI,CAAC,MAAM;gBACT,SAAS,EAAE;gBACX,UAAU;gBACV,WAAW,CAAC;gBACZ;YACF;YACA,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SACpB,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,gBAAgB,KAAK,EAAE,EAC1B,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM;YAC1C,MAAM,OAAQ,QAAQ,EAAE;YACxB,SAAS;YACT,UAAU,KAAK,MAAM,CAAC,CAAC,IAAM,CAAC,EAAE,OAAO,EAAE,MAAM;YAC/C,MAAM,MAAM,MAAM,IAAI,CAAC,IAAI,IAAI,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC,IAAmB,CAAC,CAAC;YACzF,IAAI,IAAI,MAAM,EAAE;gBACd,MAAM,EAAE,MAAM,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,0CACP,EAAE,CAAC,MAAM;gBACZ,MAAM,MAA2B,CAAC;gBACjC,CAAC,SAAS,EAAE,EAAE,OAAO,CAAC,CAAC;oBAAa,GAAG,CAAC,EAAE,EAAE,CAAC,GAAG;gBAAE;gBACnD,WAAW;YACb,OAAO;gBACL,WAAW,CAAC;YACd;QACF,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;0CAAC;YACR;QACF;yCAAG,EAAE;IAEL,MAAM,cAAc;QAClB,MAAM,MAAM,MAAM,MAAM,CAAC,CAAC,IAAM,CAAC,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;QAC3D,IAAI,CAAC,IAAI,MAAM,EAAE;QACjB,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC;YAAE,SAAS,IAAI,OAAO,WAAW;QAAG,GAAG,EAAE,CAAC,MAAM;QAC5F,SAAS,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAM,CAAC;oBAAE,GAAG,CAAC;oBAAE,SAAS,EAAE,OAAO,IAAI,IAAI,OAAO,WAAW;gBAAG,CAAC;QAC5F,UAAU;IACZ;IAEA,MAAM,WAAW,OAAO;QACtB,MAAM,MAAM,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACvC,IAAI,CAAC,OAAO,IAAI,OAAO,EAAE;QACzB,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC;YAAE,SAAS,IAAI,OAAO,WAAW;QAAG,GAAG,EAAE,CAAC,MAAM;QAC5F,SAAS,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,KAAK;oBAAE,GAAG,CAAC;oBAAE,SAAS,IAAI,OAAO,WAAW;gBAAG,IAAI;QAC/F,UAAU,CAAC,IAAM,KAAK,GAAG,CAAC,GAAG,IAAI;IACnC;IAEA,MAAM,sBAAsB,OAAO,IAAY;QAC7C,IAAI,CAAC,mBAAmB;QACxB,IAAI;YACF,mBAAmB;YACnB,MAAM,MAAM,MAAM,MAAM,uBAAuB;gBAC7C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAkB;YAC3C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,SAAS;gBACf,SAAS,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,MAAM;wBAA0B,IAAI;YAC/F;QACF,EAAE,OAAM,CAAC,SACD;YAAE,mBAAmB;QAAM;IACrC;IAEA,MAAM,aAAa,CAAC;QAClB,MAAM,IAAI,EAAE,SAAS,GAAG,OAAO,CAAC,EAAE,SAAS,CAAC,GAAG;QAC/C,MAAM,OAAO,GAAG,gBAAgB,GAAG,YAAY;QAC/C,IAAI,EAAE,IAAI,KAAK,kBAAkB,OAAO,GAAG,KAAK,0BAA0B,CAAC;QAC3E,IAAI,EAAE,IAAI,KAAK,qBAAqB,OAAO,GAAG,KAAK,4BAA4B,CAAC;QAChF,OAAO,EAAE,OAAO,IAAI;IACtB;IAEA,MAAM,uBAAuB,OAAO,IAAY;QAC9C,IAAI,CAAC,mBAAmB;QACxB,IAAI;YACF,mBAAmB;YACnB,MAAM,MAAM,MAAM,MAAM,wBAAwB;gBAC9C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAkB;YAC3C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,SAAS;gBACf,SAAS,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,MAAM;wBAA0B,IAAI;YAC/F;QACF,EAAE,OAAM,CAAC,SACD;YAAE,mBAAmB;QAAM;IACrC;IAEA,qBACE,6LAAC,8KAAY;QAAC,MAAM;QAAM,cAAc;;0BACtC,6LAAC,iLAAe;gBAAC,OAAO;0BACtB,cAAA,6LAAC,wIAAM;oBAAC,SAAQ;oBAAU,MAAK;oBAAO,WAAU;oBAAwB,cAAW;oBAAgB,SAAS;wBAAQ,IAAI,CAAC,MAAM;oBAAU;;sCACvI,6LAAC,6MAAI;4BAAC,WAAU;;;;;;wBACf,SAAS,mBACR,6LAAC;4BAAK,WAAU;sCACb;;;;;;;;;;;;;;;;;0BAKT,6LAAC,gLAAc;0BACb,cAAA,6LAAC,iLAAe;oBAAC,YAAY;oBAAG,OAAM;oBAAM,WAAU;;sCACpD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;8CAAwB;;;;;;8CACvC,6LAAC,wIAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAK,WAAU;oCAAmB,SAAS;oCAAa,UAAU,WAAW;;sDAC1G,6LAAC,gNAAK;4CAAC,WAAU;;;;;;wCAAqB;;;;;;;;;;;;;sCAG1C,6LAAC,sIAAK;4BAAC,aAAY;4BAAS,OAAO;4BAAQ,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;4BAAG,WAAU;;;;;;sCACjG,6LAAC;4BAAI,WAAU;sCACZ,wBACC,6LAAC;gCAAI,WAAU;0CAA6B;;;;;uCAC1C,MAAM,MAAM,CAAC,CAAC,IAAM,WAAW,GAAG,WAAW,GAAG,QAAQ,CAAC,OAAO,WAAW,KAAK,MAAM,KAAK,kBAC7F,6LAAC;gCAAI,WAAU;0CAA6B;;;;;uCAE5C,MACG,MAAM,CAAC,CAAC,IAAM,WAAW,GAAG,WAAW,GAAG,QAAQ,CAAC,OAAO,WAAW,KACrE,GAAG,CAAC,CAAC;gCACJ,MAAM,IAAI,EAAE,SAAS,GAAG,OAAO,CAAC,EAAE,SAAS,CAAC,GAAG;gCAC/C,MAAM,OAAO,GAAG,gBAAgB,GAAG,YAAY;gCAC/C,MAAM,YAAY,EAAE,IAAI,KAAK;gCAC7B,MAAM,aAAa,EAAE,IAAI,KAAK;gCAC9B,MAAM,aAAa,EAAE,IAAI,KAAK;gCAC9B,qBACE,6LAAC;oCAAe,WAAW,CAAC,8CAA8C,EAAE,EAAE,OAAO,GAAG,eAAe,IAAI;;wCACxG,EAAE,SAAS,iBACV,6LAAC,0KAAI;4CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,SAAS,EAAE;4CAAE,WAAU;sDAC/C,cAAA,6LAAC;gDAAI,KAAK,GAAG,cAAc;gDAAoB,KAAK;gDAAM,WAAU;;;;;;;;;;iEAGtE,6LAAC;4CAAI,KAAK,GAAG,cAAc;4CAAoB,KAAK;4CAAM,WAAU;;;;;;sDAEtE,6LAAC;4CAAI,WAAU;;gDACZ,EAAE,SAAS,iBACV,6LAAC,0KAAI;oDAAC,MAAM,CAAC,SAAS,EAAE,EAAE,SAAS,EAAE;oDAAE,WAAU;oDAAiC,OAAO;8DAAO;;;;;yEAEhG,6LAAC;oDAAI,WAAU;oDAAiC,OAAO;8DAAO;;;;;;8DAEhE,6LAAC;oDAAI,WAAU;oDAA4D,OAAO,WAAW;8DAAK,WAAW;;;;;;;;;;;;wCAE9G,aAAa,CAAC,EAAE,OAAO,iBACtB,6LAAC;4CAAI,WAAU;;8DACb,6LAAC,wIAAM;oDAAC,SAAQ;oDAAU,MAAK;oDAAK,WAAU;oDAAmB,SAAS,oBAAoB,EAAE,EAAE;oDAAE,SAAS;wDAAc,MAAM,oBAAoB,EAAE,EAAE,EAAE,EAAE,iBAAiB;oDAAE;;sEAC9K,6LAAC,gNAAK;4DAAC,WAAU;;;;;;wDAAqB;;;;;;;8DAExC,6LAAC,wIAAM;oDAAC,SAAQ;oDAAU,MAAK;oDAAK,WAAU;oDAAmB,SAAS,oBAAoB,EAAE,EAAE;oDAAE,SAAS;wDAAc,MAAM,qBAAqB,EAAE,EAAE,EAAE,EAAE,iBAAiB;oDAAE;;sEAC/K,6LAAC,mOAAU;4DAAC,WAAU;;;;;;wDAAqB;;;;;;;;;;;;mDAG7C,2BACF,6LAAC;4CAAI,WAAU;sDAA+D;;;;;mDAC5E,2BACF,6LAAC;4CAAI,WAAU;sDAA6C;;;;;mDAC1D,EAAE,OAAO,iBACX,6LAAC,wIAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,WAAU;4CAAmB,SAAS;gDAAc,MAAM,SAAS,EAAE,EAAE;gDAAG,OAAO,IAAI,CAAC,CAAC,MAAM,EAAE,EAAE,OAAO,EAAE;gDAAG,QAAQ;4CAAO;sDAC9J,cAAA,6LAAC,mOAAU;gDAAC,WAAU;;;;;;;;;;iEAGxB,6LAAC,wIAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,WAAU;4CAAmB,SAAS;gDAAc,MAAM,SAAS,EAAE,EAAE;gDAAG,QAAQ;4CAAO;sDAC3H,cAAA,6LAAC,gNAAK;gDAAC,WAAU;;;;;;;;;;;;mCAnCb,EAAE,EAAE;;;;;4BAwClB;;;;;;;;;;;;;;;;;;;;;;;AAOhB;GA/LgB;;QAEC,kJAAS;;;KAFV"}},
    {"offset": {"line": 1326, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/giphy-picker.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Search, X, Loader2 } from 'lucide-react'\r\nimport * as Dialog from '@radix-ui/react-dialog'\r\n\r\ninterface GiphyPickerProps {\r\n    onSelect: (gifUrl: string) => void\r\n    open: boolean\r\n    onOpenChange: (open: boolean) => void\r\n}\r\n\r\nexport function GiphyPicker({ onSelect, open, onOpenChange }: GiphyPickerProps) {\r\n    const [search, setSearch] = useState('')\r\n    const [gifs, setGifs] = useState<any[]>([])\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    // Using Giphy's public beta key - users should replace with their own\r\n    const GIPHY_API_KEY = 'sXpGFDGZs0Dv1mmNFvYaGUvYwKX0PWIh'\r\n\r\n    useEffect(() => {\r\n        if (open) {\r\n            loadTrending()\r\n        }\r\n    }, [open])\r\n\r\n    const loadTrending = async () => {\r\n        setLoading(true)\r\n        try {\r\n            const response = await fetch(\r\n                `https://api.giphy.com/v1/gifs/trending?api_key=${GIPHY_API_KEY}&limit=20&rating=g`\r\n            )\r\n            const data = await response.json()\r\n            setGifs(data.data || [])\r\n        } catch (error) {\r\n            console.error('Failed to load trending GIFs:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const searchGifs = async (query: string) => {\r\n        if (!query.trim()) {\r\n            loadTrending()\r\n            return\r\n        }\r\n\r\n        setLoading(true)\r\n        try {\r\n            const response = await fetch(\r\n                `https://api.giphy.com/v1/gifs/search?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(query)}&limit=20&rating=g`\r\n            )\r\n            const data = await response.json()\r\n            setGifs(data.data || [])\r\n        } catch (error) {\r\n            console.error('Failed to search GIFs:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const handleSearch = (e: React.FormEvent) => {\r\n        e.preventDefault()\r\n        searchGifs(search)\r\n    }\r\n\r\n    const handleSelectGif = (gif: any) => {\r\n        const gifUrl = gif.images.fixed_height.url\r\n        onSelect(gifUrl)\r\n        onOpenChange(false)\r\n        setSearch('')\r\n    }\r\n\r\n    return (\r\n        <Dialog.Root open={open} onOpenChange={onOpenChange}>\r\n            <Dialog.Portal>\r\n                <Dialog.Overlay className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50\" />\r\n                <Dialog.Content className=\"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-background border border-border rounded-2xl shadow-2xl w-[90vw] max-w-2xl max-h-[80vh] overflow-hidden z-50 flex flex-col\">\r\n                    <div className=\"p-4 border-b border-border flex items-center justify-between\">\r\n                        <Dialog.Title className=\"text-lg font-bold\">Choose a GIF</Dialog.Title>\r\n                        <Dialog.Close asChild>\r\n                            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\">\r\n                                <X className=\"w-5 h-5\" />\r\n                            </Button>\r\n                        </Dialog.Close>\r\n                    </div>\r\n\r\n                    <div className=\"p-4 border-b border-border\">\r\n                        <form onSubmit={handleSearch} className=\"flex gap-2\">\r\n                            <Input\r\n                                placeholder=\"Search GIFs...\"\r\n                                value={search}\r\n                                onChange={(e) => setSearch(e.target.value)}\r\n                                className=\"flex-1\"\r\n                            />\r\n                            <Button type=\"submit\" size=\"icon\" disabled={loading}>\r\n                                {loading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Search className=\"w-4 h-4\" />}\r\n                            </Button>\r\n                        </form>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-y-auto p-4\">\r\n                        {loading && gifs.length === 0 ? (\r\n                            <div className=\"flex items-center justify-center h-full\">\r\n                                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-2\">\r\n                                {gifs.map((gif) => (\r\n                                    <button\r\n                                        key={gif.id}\r\n                                        onClick={() => handleSelectGif(gif)}\r\n                                        className=\"relative aspect-square rounded-lg overflow-hidden hover:ring-2 hover:ring-primary transition-all group\"\r\n                                    >\r\n                                        <img\r\n                                            src={gif.images.fixed_height_small.url}\r\n                                            alt={gif.title}\r\n                                            className=\"w-full h-full object-cover\"\r\n                                        />\r\n                                        <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors\" />\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"p-3 border-t border-border text-center\">\r\n                        <p className=\"text-xs text-muted-foreground\">Powered by GIPHY</p>\r\n                    </div>\r\n                </Dialog.Content>\r\n            </Dialog.Portal>\r\n        </Dialog.Root>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1601, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/components/typing-indicator.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { createClient } from '@/lib/supabase/client'\r\n\r\ninterface TypingIndicatorProps {\r\n  roomId: string\r\n  currentUserId: string\r\n}\r\n\r\nexport function TypingIndicator({ roomId, currentUserId }: TypingIndicatorProps) {\r\n  const [typingUsers, setTypingUsers] = useState<string[]>([])\r\n  const supabase = createClient()\r\n\r\n  useEffect(() => {\r\n    if (!roomId) return\r\n\r\n    const channel = supabase.channel(`typing:${roomId}`)\r\n\r\n    channel\r\n      .on('broadcast', { event: 'typing' }, ({ payload }: any) => {\r\n        if (payload.user_id === currentUserId) return\r\n\r\n        setTypingUsers((prev) => {\r\n          if (payload.is_typing && !prev.includes(payload.username)) {\r\n            return [...prev, payload.username]\r\n          } else if (!payload.is_typing) {\r\n            return prev.filter((u) => u !== payload.username)\r\n          }\r\n          return prev\r\n        })\r\n\r\n        // Auto-remove after 3 seconds\r\n        if (payload.is_typing) {\r\n          setTimeout(() => {\r\n            setTypingUsers((prev) => prev.filter((u) => u !== payload.username))\r\n          }, 3000)\r\n        }\r\n      })\r\n      .subscribe()\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel)\r\n    }\r\n  }, [roomId, currentUserId, supabase])\r\n\r\n  if (typingUsers.length === 0) return null\r\n\r\n  return (\r\n    <div className=\"px-4 py-2 flex items-center gap-2\">\r\n      <div className=\"flex items-center gap-1 px-3 py-2 bg-secondary/50 rounded-3xl rounded-bl-sm w-fit\">\r\n        <div className=\"w-2 h-2 bg-foreground/60 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\r\n        <div className=\"w-2 h-2 bg-foreground/60 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\r\n        <div className=\"w-2 h-2 bg-foreground/60 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\r\n      </div>\r\n      <span className=\"text-sm text-muted-foreground\">\r\n        {typingUsers.length === 1 && `${typingUsers[0]} is typing...`}\r\n        {typingUsers.length === 2 && `${typingUsers[0]} and ${typingUsers[1]} are typing...`}\r\n        {typingUsers.length > 2 && `${typingUsers.length} people are typing...`}\r\n      </span>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAUO,SAAS,gBAAgB,EAAE,MAAM,EAAE,aAAa,EAAwB;;IAC7E,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAW,EAAE;IAC3D,MAAM,WAAW,IAAA,4IAAY;IAE7B,IAAA,0KAAS;qCAAC;YACR,IAAI,CAAC,QAAQ;YAEb,MAAM,UAAU,SAAS,OAAO,CAAC,CAAC,OAAO,EAAE,QAAQ;YAEnD,QACG,EAAE,CAAC,aAAa;gBAAE,OAAO;YAAS;6CAAG,CAAC,EAAE,OAAO,EAAO;oBACrD,IAAI,QAAQ,OAAO,KAAK,eAAe;oBAEvC;qDAAe,CAAC;4BACd,IAAI,QAAQ,SAAS,IAAI,CAAC,KAAK,QAAQ,CAAC,QAAQ,QAAQ,GAAG;gCACzD,OAAO;uCAAI;oCAAM,QAAQ,QAAQ;iCAAC;4BACpC,OAAO,IAAI,CAAC,QAAQ,SAAS,EAAE;gCAC7B,OAAO,KAAK,MAAM;iEAAC,CAAC,IAAM,MAAM,QAAQ,QAAQ;;4BAClD;4BACA,OAAO;wBACT;;oBAEA,8BAA8B;oBAC9B,IAAI,QAAQ,SAAS,EAAE;wBACrB;yDAAW;gCACT;iEAAe,CAAC,OAAS,KAAK,MAAM;yEAAC,CAAC,IAAM,MAAM,QAAQ,QAAQ;;;4BACpE;wDAAG;oBACL;gBACF;4CACC,SAAS;YAEZ;6CAAO;oBACL,SAAS,aAAa,CAAC;gBACzB;;QACF;oCAAG;QAAC;QAAQ;QAAe;KAAS;IAEpC,IAAI,YAAY,MAAM,KAAK,GAAG,OAAO;IAErC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;wBAAuD,OAAO;4BAAE,gBAAgB;wBAAM;;;;;;kCACrG,6LAAC;wBAAI,WAAU;wBAAuD,OAAO;4BAAE,gBAAgB;wBAAQ;;;;;;kCACvG,6LAAC;wBAAI,WAAU;wBAAuD,OAAO;4BAAE,gBAAgB;wBAAQ;;;;;;;;;;;;0BAEzG,6LAAC;gBAAK,WAAU;;oBACb,YAAY,MAAM,KAAK,KAAK,GAAG,WAAW,CAAC,EAAE,CAAC,aAAa,CAAC;oBAC5D,YAAY,MAAM,KAAK,KAAK,GAAG,WAAW,CAAC,EAAE,CAAC,KAAK,EAAE,WAAW,CAAC,EAAE,CAAC,cAAc,CAAC;oBACnF,YAAY,MAAM,GAAG,KAAK,GAAG,YAAY,MAAM,CAAC,qBAAqB,CAAC;;;;;;;;;;;;;AAI/E;GApDgB;KAAA"}},
    {"offset": {"line": 1739, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/app/room/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Card } from '@/components/ui/card'\nimport { ChatBubble } from '@/components/chat-bubble'\nimport { ThemeToggle } from '@/components/theme-toggle'\nimport { SendHorizontal, Smile, Paperclip, MoreVertical, Edit, Trash2, X, Copy, MessageCircle, Check, ChevronLeft, Image as ImageIconLucide } from 'lucide-react'\nimport * as Dialog from '@radix-ui/react-dialog'\nimport Link from 'next/link'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\nimport { NotificationsPopover } from '@/components/notifications-popover'\nimport { GiphyPicker } from '@/components/giphy-picker'\nimport { TypingIndicator } from '@/components/typing-indicator'\nimport { VoiceRecorder } from '@/components/voice-recorder'\nimport { ThemeSelector } from '@/components/theme-selector'\n\ninterface Message {\n  id: string\n  content: string\n  created_at: string\n  user_id: string\n  media_url?: string\n  media_type?: string\n  profiles?: {\n    username: string\n    avatar_url?: string\n  }\n  reactions?: { emoji: string; user_id: string }[]\n}\n\ninterface Room {\n  id: string\n  name: string\n  emoji: string\n  topic: string\n  description?: string\n  member_count?: number\n  created_by?: string\n}\n\nexport default function ChatRoom({ params }: { params: Promise<{ id: string }> | { id: string } }) {\n  const [messages, setMessages] = useState<Message[]>([])\n  const [visibleCount, setVisibleCount] = useState<number>(200)\n  const [room, setRoom] = useState<Room | null>(null)\n  const [inputValue, setInputValue] = useState('')\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false)\n  const [loading, setLoading] = useState(true)\n  const [sending, setSending] = useState(false)\n  const [currentUser, setCurrentUser] = useState<any>(null)\n  const [roomId, setRoomId] = useState<string>('')\n  const [joined, setJoined] = useState(false)\n  const [selectedFile, setSelectedFile] = useState<File | null>(null)\n  const [uploadingMedia, setUploadingMedia] = useState(false)\n  const [showRoomMenu, setShowRoomMenu] = useState(false)\n  const [startingGuest, setStartingGuest] = useState(false)\n  const [inviteCreating, setInviteCreating] = useState(false)\n  const [inviteToken, setInviteToken] = useState<string | null>(null)\n  const [inviteError, setInviteError] = useState<string | null>(null)\n  const [friends, setFriends] = useState<any[]>([])\n  const [showAddFriends, setShowAddFriends] = useState(false)\n  const [selectedFriendIds, setSelectedFriendIds] = useState<string[]>([])\n  const [friendSearch, setFriendSearch] = useState('')\n  const [selectionMode, setSelectionMode] = useState(false)\n  const [selectedMessageIds, setSelectedMessageIds] = useState<Set<string>>(new Set())\n  const [showGiphyPicker, setShowGiphyPicker] = useState(false)\n  const typingChannelRef = useRef<any>(null)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const messagesContainerRef = useRef<HTMLDivElement>(null)\n  const sendQueueRef = useRef<any[]>([])\n  const flushTimerRef = useRef<number | null>(null)\n  const lastInputEventTimeRef = useRef<number | null>(null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const messageInputRef = useRef<HTMLInputElement>(null)\n  const receivedIdsRef = useRef<Set<string>>(new Set())\n  const lastImmediateSendRef = useRef<number | null>(null)\n  const [latencies, setLatencies] = useState<number[]>([])\n  const supabase = createClient()\n  const searchParams = typeof window !== 'undefined' ? new URLSearchParams(window.location.search) : null\n  const [joinError, setJoinError] = useState<string | null>(null)\n  const router = useRouter()\n\n  const handleLeaveRoom = async () => {\n    try {\n      if (!currentUser?.id || !roomId) { router.push('/'); return }\n      await supabase\n        .from('room_members')\n        .delete()\n        .eq('room_id', roomId)\n        .eq('user_id', currentUser.id)\n      router.push('/')\n    } catch (e) {\n      router.push('/')\n    }\n  }\n\n  // Handle async params for Next.js 16\n  useEffect(() => {\n    const getRoomId = async () => {\n      const resolvedParams = await Promise.resolve(params)\n      setRoomId(resolvedParams.id)\n    }\n    getRoomId()\n  }, [params])\n\n  const scrollToBottom = () => {\n    requestAnimationFrame(() => {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\n    })\n  }\n\n  const handleCreateInvite = async () => {\n    setInviteCreating(true)\n    setInviteError(null)\n    setInviteToken(null)\n    try {\n      const res = await fetch('/api/rooms/invite/create', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ room_id: roomId }),\n      })\n      const data = await res.json()\n      if (!res.ok) throw new Error(data.error || 'Failed to create invite')\n      setInviteToken(data.token)\n    } catch (e) {\n      const msg = e instanceof Error ? e.message : 'Failed to create invite'\n      setInviteError(msg)\n    } finally {\n      setInviteCreating(false)\n    }\n  }\n\n  const loadFriends = async () => {\n    try {\n      const res = await fetch('/api/friends/get?status=accepted')\n      const data = await res.json()\n      if (res.ok) {\n        const list = ((data?.friends || data) as any[]) || []\n        const ids = list\n          .map((f: any) => f.friend_id || f.user_id || f.id)\n          .filter((x: any) => !!x)\n        if (ids.length > 0) {\n          const { data: profs } = await supabase\n            .from('profiles')\n            .select('id, username, display_name, avatar_url')\n            .in('id', ids)\n          const map = new Map((profs || []).map((p: any) => [p.id, p]))\n          const enriched = list.map((f: any) => {\n            const fid = f.friend_id || f.user_id || f.id\n            const p = fid ? map.get(fid) : null\n            return {\n              ...f,\n              id: fid,\n              display_name: f.display_name || p?.display_name || f.username || p?.username,\n              username: f.username || p?.username,\n              avatar_url: f.avatar_url || p?.avatar_url,\n            }\n          })\n          setFriends(enriched)\n        } else {\n          setFriends(list)\n        }\n      }\n    } catch { }\n  }\n\n  const [addingFriends, setAddingFriends] = useState(false)\n  const handleAddSelectedFriends = async () => {\n    try {\n      setAddingFriends(true)\n      if (!roomId || selectedFriendIds.length === 0) { setShowAddFriends(false); return }\n      const rows = selectedFriendIds.map((id) => ({ room_id: roomId, user_id: id }))\n      await supabase.from('room_members').insert(rows)\n      try {\n        await fetch('/api/notifications/bulk', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ recipients: selectedFriendIds, type: 'room_member_added', room_id: roomId }),\n        })\n      } catch { }\n      setShowAddFriends(false)\n      setSelectedFriendIds([])\n    } catch {\n      setShowAddFriends(false)\n    } finally {\n      setAddingFriends(false)\n    }\n  }\n\n  const pushSystemMessage = (text: string) => {\n    const msg: Message = {\n      id: `sys_${Date.now()}`,\n      content: text,\n      created_at: new Date().toISOString(),\n      user_id: 'system',\n      profiles: { username: 'System' },\n    }\n    setMessages((prev) => [...prev, msg])\n    setTimeout(scrollToBottom, 100)\n  }\n\n  // Join first if possible (needed for private rooms with invites)\n  useEffect(() => {\n    if (!roomId) return\n\n    const attemptJoin = async () => {\n      if (!currentUser?.id) return\n      try {\n        const token = searchParams?.get('token') || null\n        const res = await fetch('/api/rooms/join', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ room_id: roomId, token }),\n        })\n        if (res.ok) {\n          setJoined(true)\n          setJoinError(null)\n        } else {\n          const msg = res.status === 403 ? 'Invite required or invalid' : res.status === 409 ? 'Room is full' : 'Failed to join'\n          setJoinError(msg)\n        }\n      } catch { }\n    }\n\n    attemptJoin()\n  }, [roomId, currentUser])\n\n  // Fetch room information\n  useEffect(() => {\n    if (!roomId) return\n\n    const fetchRoom = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('rooms')\n          .select('*')\n          .eq('id', roomId)\n          .single()\n\n        if (error) throw error\n        setRoom(data)\n      } catch (err) {\n        console.error('Error fetching room:', err)\n        setLoading(false)\n        setJoinError('Room not found or you do not have access')\n      }\n    }\n\n    fetchRoom()\n  }, [roomId, supabase])\n\n  // Get current user\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser()\n      setCurrentUser(user)\n    }\n    getUser()\n  }, [supabase])\n\n  // Join membership on mount; attempt robust cleanup on unmount and page leave\n  useEffect(() => {\n    const join = async () => {\n      if (!roomId || !currentUser?.id) return\n      try {\n        // Already attempted a join above; no-op here\n        setJoinError(null)\n      } catch { }\n    }\n    join()\n\n    const cleanup = async () => {\n      if (!roomId || !currentUser?.id) return\n      try {\n        await supabase\n          .from('room_members')\n          .delete()\n          .eq('room_id', roomId)\n          .eq('user_id', currentUser.id)\n      } catch { }\n    }\n\n    let hb: number | null = null\n    const startHeartbeat = () => {\n      if (!roomId) return\n      const send = () => {\n        try {\n          fetch('/api/room-members/heartbeat', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ room_id: roomId }),\n            keepalive: true,\n          }).catch(() => { })\n        } catch { }\n      }\n      send()\n      hb = window.setInterval(send, 25_000)\n    }\n    startHeartbeat()\n\n    const sendBeaconLeave = () => {\n      if (!roomId) return\n      try {\n        const body = new Blob([JSON.stringify({ room_id: roomId })], { type: 'application/json' })\n        navigator.sendBeacon('/api/room-members/leave', body)\n      } catch { }\n    }\n\n    const onBeforeUnload = () => {\n      sendBeaconLeave()\n    }\n    const onVisibilityChange = () => {\n      if (document.visibilityState === 'hidden') sendBeaconLeave()\n    }\n    window.addEventListener('beforeunload', onBeforeUnload)\n    document.addEventListener('visibilitychange', onVisibilityChange)\n\n    return () => {\n      window.removeEventListener('beforeunload', onBeforeUnload)\n      document.removeEventListener('visibilitychange', onVisibilityChange)\n      if (hb) { try { window.clearInterval(hb) } catch { } }\n      try { cleanup() } catch { }\n    }\n  }, [roomId, currentUser, supabase, room])\n\n  // Fetch initial messages\n  useEffect(() => {\n    const ac = new AbortController()\n    const fetchMessages = async () => {\n      try {\n        const response = await fetch(`/api/chat/get-messages?room_id=${roomId}`, { signal: ac.signal })\n        if (!response.ok) throw new Error('Failed to fetch messages')\n        let data: any = []\n        try {\n          data = await response.json()\n        } catch {\n          data = []\n        }\n        performance.mark('messages_fetch_start')\n        setMessages(data || [])\n        const ids = new Set<string>((data || []).map((m: any) => String(m.id)))\n        receivedIdsRef.current = ids\n        setLoading(false)\n        requestAnimationFrame(() => {\n          performance.mark('messages_render_end')\n          performance.measure('messages_initial_render', 'messages_fetch_start', 'messages_render_end')\n        })\n        setTimeout(scrollToBottom, 100)\n      } catch (err) {\n        const name = (err as any)?.name\n        if (name !== 'AbortError') {\n          console.error('Error fetching messages:', err)\n        }\n        setLoading(false)\n      }\n    }\n\n    if (roomId) {\n      fetchMessages()\n    }\n    return () => { try { ac.abort() } catch { } }\n  }, [roomId])\n\n  // Subscribe to real-time messages\n  useEffect(() => {\n    if (!roomId) return\n\n    const channel = supabase\n      .channel(`room:${roomId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'messages',\n          filter: `room_id=eq.${roomId}`,\n        },\n        async (payload) => {\n          if (receivedIdsRef.current.has(payload.new.id)) { return }\n          // Fetch the new message with profile data\n          const { data: newMessage } = await supabase\n            .from('messages')\n            .select(`\n              *,\n              *,\n              profiles (username, avatar_url),\n              reactions (emoji, user_id)\n            `)\n            .eq('id', payload.new.id)\n            .single()\n\n          if (newMessage) {\n            receivedIdsRef.current.add(newMessage.id)\n            performance.mark('message_append_start')\n            setMessages((prev) => {\n              if (prev.some(m => m.id === newMessage.id)) return prev\n              return [...prev, newMessage]\n            })\n            requestAnimationFrame(() => {\n              performance.mark('message_append_end')\n              performance.measure('message_append_render', 'message_append_start', 'message_append_end')\n            })\n            setTimeout(scrollToBottom, 100)\n          }\n        }\n      )\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [roomId, supabase])\n\n  // Subscribe to reactions\n  useEffect(() => {\n    if (!roomId) return\n\n    const channel = supabase\n      .channel(`reactions:${roomId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'reactions',\n        },\n        async (payload) => {\n          const messageId = (payload.new as any)?.message_id || (payload.old as any)?.message_id\n          if (!messageId) return\n\n          const { data: reactions } = await supabase\n            .from('reactions')\n            .select('emoji, user_id')\n            .eq('message_id', messageId)\n\n          setMessages((prev) =>\n            prev.map((msg) =>\n              msg.id === messageId\n                ? { ...msg, reactions: reactions || [] }\n                : msg\n            )\n          )\n        }\n      )\n      .subscribe()\n\n    return () => {\n      supabase.removeChannel(channel)\n    }\n  }, [roomId, supabase])\n\n  // Auto-scroll when new messages arrive\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages])\n\n  // Track read receipts\n  useEffect(() => {\n    if (!currentUser || !roomId || messages.length === 0) return\n\n    const updateReadReceipt = async () => {\n      const lastMessage = messages[messages.length - 1]\n      if (!lastMessage || lastMessage.user_id === currentUser.id) return\n\n      try {\n        await fetch('/api/chat/update-read-receipt', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            room_id: roomId,\n            last_read_message_id: lastMessage.id,\n          }),\n        })\n      } catch (error) {\n        console.error('Failed to update read receipt:', error)\n      }\n    }\n\n    const timer = setTimeout(updateReadReceipt, 1000)\n    return () => clearTimeout(timer)\n  }, [messages, currentUser, roomId])\n\n  useEffect(() => {\n    const el = messagesContainerRef.current\n    if (!el) return\n    let ticking = false\n    const onScroll = () => {\n      if (!ticking) {\n        ticking = true\n        requestAnimationFrame(() => {\n          ticking = false\n        })\n      }\n    }\n    el.addEventListener('scroll', onScroll, { passive: true })\n    return () => {\n      el.removeEventListener('scroll', onScroll as any)\n    }\n  }, [])\n\n  // Setup typing indicator channel\n  useEffect(() => {\n    if (!roomId || !currentUser) return\n\n    const channel = supabase.channel(`typing:${roomId}`)\n    channel.subscribe()\n    typingChannelRef.current = channel\n\n    return () => {\n      if (typingChannelRef.current) {\n        supabase.removeChannel(typingChannelRef.current)\n      }\n    }\n  }, [roomId, currentUser, supabase])\n\n  const broadcastTyping = (isTyping: boolean) => {\n    if (!typingChannelRef.current || !currentUser) return\n\n    typingChannelRef.current.send({\n      type: 'broadcast',\n      event: 'typing',\n      payload: {\n        user_id: currentUser.id,\n        username: currentUser.user_metadata?.username || 'User',\n        is_typing: isTyping,\n      },\n    })\n  }\n\n  const tryGzip = async (data: any) => {\n    try {\n      // @ts-ignore\n      if (typeof CompressionStream !== 'undefined') {\n        // @ts-ignore\n        const cs = new CompressionStream('gzip')\n        const blob = new Blob([JSON.stringify(data)], { type: 'application/json' })\n        const stream = blob.stream().pipeThrough(cs)\n        const compressed = await new Response(stream).arrayBuffer()\n        return new Uint8Array(compressed)\n      }\n    } catch { }\n    return null\n  }\n\n  const flushQueue = async () => {\n    if (!sendQueueRef.current.length) return\n    const batch = sendQueueRef.current.splice(0, sendQueueRef.current.length)\n    if (batch.length === 1) {\n      const m = batch[0]\n      const clientTs = m.client_ts || performance.now()\n      const response = await fetch('/api/chat/send-message', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ room_id: roomId, content: m.content, media_url: m.media_url || null, media_type: m.media_type || null, client_ts: clientTs }),\n      })\n      if (response.ok) {\n        const t = Math.round(performance.now() - clientTs)\n        try { console.log('send_latency_ms', t) } catch { }\n        setLatencies((prev) => { const arr = prev.slice(-49); arr.push(t); return arr })\n        return\n      }\n      try {\n        const err = await response.json()\n        console.error('Send error:', err)\n        if ((response.status === 401 || response.status === 403)) {\n          pushSystemMessage('Create an account to send messages')\n        } else {\n          pushSystemMessage('Message failed to send. Please try again')\n        }\n      } catch {\n        pushSystemMessage('Message failed to send. Please try again')\n      }\n      return\n    }\n    const gz = await tryGzip({ room_id: roomId, messages: batch })\n    const response = await fetch('/api/chat/send-batch', {\n      method: 'POST',\n      headers: gz ? { 'Content-Encoding': 'gzip' } : { 'Content-Type': 'application/json' },\n      body: gz ? (gz as any) : JSON.stringify({ room_id: roomId, messages: batch }),\n    })\n    if (response.ok) {\n      let data: any = null\n      try { data = await response.json() } catch { data = null }\n      const items: any[] = data?.data || []\n      items.forEach((row) => {\n        const tmpId = row?.tmp_id\n        if (row?.id && tmpId) {\n          receivedIdsRef.current.add(row.id)\n          const t = Math.round(performance.now() - (row.client_ts || performance.now()))\n          try { console.log('send_latency_ms', t) } catch { }\n          setLatencies((prev) => { const arr = prev.slice(-49); arr.push(t); return arr })\n          const finalMsg: Message = { ...row, profiles: { username: 'You' } }\n          setMessages((prev) => {\n            const map = new Map(prev.map((m) => [m.id, m]))\n            map.delete(tmpId)\n            map.set(finalMsg.id, finalMsg)\n            return Array.from(map.values())\n          })\n        }\n      })\n      return\n    }\n    try {\n      const err = await response.json()\n      console.error('Batch send error:', err)\n      if ((response.status === 401 || response.status === 403)) {\n        pushSystemMessage('Create an account to send messages')\n      } else {\n        pushSystemMessage('Message failed to send. Please try again')\n      }\n    } catch {\n      pushSystemMessage('Message failed to send. Please try again')\n    }\n  }\n\n  const scheduleFlush = () => {\n    if (flushTimerRef.current) return\n    flushTimerRef.current = setTimeout(() => {\n      flushTimerRef.current = null\n      flushQueue()\n    }, 180) as unknown as number\n  }\n\n  const enqueueMessage = (payload: { content: string; media_url?: string | null; media_type?: string | null; client_ts?: number; tmp_id?: string }) => {\n    sendQueueRef.current.push(payload)\n    scheduleFlush()\n  }\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n    if (isGuestUser) { pushSystemMessage('Create an account to upload images'); return }\n\n    // Validate file type\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp']\n    if (!validTypes.includes(file.type)) {\n      alert('Please select an image file (JPEG, PNG, GIF, or WebP)')\n      return\n    }\n\n    // Validate file size (max 5MB)\n    const maxSize = 5 * 1024 * 1024\n    if (file.size > maxSize) {\n      alert('File size must be less than 5MB')\n      return\n    }\n\n    setSelectedFile(file)\n  }\n\n  const handleGifSelect = async (gifUrl: string) => {\n    if (!currentUser || sending) return\n\n    setSending(true)\n    const tempId = `tmp_${Date.now()}`\n    const optimistic: Message = {\n      id: tempId,\n      content: 'üé¨ GIF',\n      created_at: new Date().toISOString(),\n      user_id: currentUser.id,\n      profiles: { username: 'You' },\n      media_url: gifUrl,\n      media_type: 'giphy',\n    }\n    setMessages((prev) => [...prev, optimistic])\n    setTimeout(scrollToBottom, 50)\n\n    try {\n      const response = await fetch('/api/chat/send-message', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          room_id: roomId,\n          content: 'üé¨ GIF',\n          media_url: gifUrl,\n          media_type: 'giphy'\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to send GIF')\n      }\n\n      const data = await response.json()\n      if (data?.id) {\n        receivedIdsRef.current.add(data.id)\n        const finalMsg: Message = { ...data, profiles: { username: 'You' } }\n        setMessages((prev) => {\n          const map = new Map(prev.map((m) => [m.id, m]))\n          map.delete(tempId)\n          map.set(finalMsg.id, finalMsg)\n          return Array.from(map.values())\n        })\n      }\n    } catch (err) {\n      console.error('Error sending GIF:', err)\n      setMessages((prev) => prev.filter((m) => m.id !== tempId))\n    } finally {\n      setSending(false)\n    }\n  }\n\n  const handleVoiceRecording = async (audioBlob: Blob) => {\n    if (!currentUser || sending) return\n\n    setSending(true)\n    setUploadingMedia(true)\n    const tempId = `tmp_${Date.now()}`\n    const optimistic: Message = {\n      id: tempId,\n      content: 'üé§ Voice Message',\n      created_at: new Date().toISOString(),\n      user_id: currentUser.id,\n      profiles: { username: 'You' },\n      media_url: 'uploading',\n      media_type: 'voice',\n    }\n    setMessages((prev) => [...prev, optimistic])\n    setTimeout(scrollToBottom, 50)\n\n    try {\n      const formData = new FormData()\n      formData.append('file', audioBlob, 'voice-message.webm')\n      formData.append('room_id', roomId)\n\n      const uploadResponse = await fetch('/api/chat/upload-media', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!uploadResponse.ok) throw new Error('Failed to upload voice message')\n\n      const uploadData = await uploadResponse.json()\n      const response = await fetch('/api/chat/send-message', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          room_id: roomId,\n          content: 'üé§ Voice Message',\n          media_url: uploadData.media_url,\n          media_type: 'voice'\n        }),\n      })\n\n      if (!response.ok) throw new Error('Failed to send voice message')\n\n      const data = await response.json()\n      if (data?.id) {\n        receivedIdsRef.current.add(data.id)\n        const finalMsg: Message = { ...data, profiles: { username: 'You' } }\n        setMessages((prev) => {\n          const map = new Map(prev.map((m) => [m.id, m]))\n          map.delete(tempId)\n          map.set(finalMsg.id, finalMsg)\n          return Array.from(map.values())\n        })\n      }\n    } catch (err) {\n      console.error('Error sending voice message:', err)\n      setMessages((prev) => prev.filter((m) => m.id !== tempId))\n    } finally {\n      setSending(false)\n      setUploadingMedia(false)\n    }\n  }\n\n  const handleSendMessage = async () => {\n    if ((!inputValue.trim() && !selectedFile) || !currentUser || sending) return\n\n    setSending(true)\n    setUploadingMedia(true)\n    let mediaUrl: string | null = null\n    let mediaType: string | null = null\n    const tempId = `tmp_${Date.now()}`\n    const optimistic: Message = {\n      id: tempId,\n      content: inputValue.trim() || (selectedFile ? 'üì∑ Photo' : ''),\n      created_at: new Date().toISOString(),\n      user_id: currentUser.id,\n      profiles: { username: 'You' },\n      media_url: selectedFile ? 'uploading' : undefined,\n      media_type: undefined,\n    }\n    setMessages((prev) => [...prev, optimistic])\n\n    // Clear input immediately for instant feedback\n    setInputValue('')\n    setSelectedFile(null)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n\n    setTimeout(scrollToBottom, 50)\n\n    try {\n      // Upload file if selected\n      if (selectedFile) {\n        if (isGuestUser) {\n          throw new Error('Media uploads are not available in Guest mode')\n        }\n        const formData = new FormData()\n        formData.append('file', selectedFile)\n        formData.append('room_id', roomId)\n\n        const uploadResponse = await fetch('/api/chat/upload-media', {\n          method: 'POST',\n          body: formData,\n        })\n\n        if (!uploadResponse.ok) {\n          throw new Error('Failed to upload media')\n        }\n\n        const uploadData = await uploadResponse.json()\n        mediaUrl = uploadData.media_url\n        mediaType = uploadData.media_type\n      }\n\n      const content = inputValue.trim() || (selectedFile ? 'üì∑ Photo' : '')\n      if (lastInputEventTimeRef.current) {\n        const latency = performance.now() - lastInputEventTimeRef.current\n        try { console.log('input_latency_ms', Math.round(latency)) } catch { }\n      }\n      const now = performance.now()\n      const withinBurst = (lastImmediateSendRef.current && (now - lastImmediateSendRef.current) < 150) || sendQueueRef.current.length > 0\n      if (withinBurst) {\n        enqueueMessage({ content, media_url: mediaUrl, media_type: mediaType, client_ts: now, tmp_id: tempId })\n      } else {\n        lastImmediateSendRef.current = now\n        const response = await fetch('/api/chat/send-message', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ room_id: roomId, content, media_url: mediaUrl || null, media_type: mediaType || null, client_ts: now }),\n        })\n        if (!response.ok) {\n          try {\n            const err = await response.json()\n            console.error('Send error:', err)\n            if ((response.status === 401 || response.status === 403)) {\n              pushSystemMessage('Create an account to send messages')\n            } else {\n              pushSystemMessage('Message failed to send. Please try again')\n            }\n          } catch {\n            pushSystemMessage('Message failed to send. Please try again')\n          }\n          setMessages((prev) => prev.filter((m) => m.id !== tempId))\n        } else {\n          let data: any = null\n          try { data = await response.json() } catch { data = null }\n          if (data?.id) {\n            receivedIdsRef.current.add(data.id)\n            const finalMsg: Message = { ...data, profiles: { username: 'You' } }\n            setMessages((prev) => {\n              const map = new Map(prev.map((m) => [m.id, m]))\n              map.delete(tempId)\n              map.set(finalMsg.id, finalMsg)\n              return Array.from(map.values())\n            })\n            const t = Math.round(performance.now() - (data.client_ts || now))\n            try { console.log('send_latency_ms', t) } catch { }\n            setLatencies((prev) => { const arr = prev.slice(-49); arr.push(t); return arr })\n          }\n        }\n      }\n\n      // Input already cleared\n    } catch (err) {\n      console.error('Error sending message:', err)\n      alert((err as any)?.message || 'Failed to send message. Please try again.')\n      setMessages((prev) => prev.filter((m) => m.id !== tempId))\n    } finally {\n      setSending(false)\n      setUploadingMedia(false)\n    }\n  }\n\n  const handleDeleteRoom = async () => {\n    if (!confirm('Are you sure you want to delete this room? This action cannot be undone.')) {\n      return\n    }\n\n    try {\n      const response = await fetch(`/api/rooms/delete?id=${roomId}`, {\n        method: 'DELETE',\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to delete room')\n      }\n\n      router.push('/')\n    } catch (err) {\n      console.error('Error deleting room:', err)\n      alert('Failed to delete room. Please try again.')\n    }\n  }\n\n  const isRoomOwner = currentUser && room && room.created_by === currentUser.id\n  const isGuestUser = !!currentUser && (((currentUser as any).is_anonymous) || ((currentUser as any).app_metadata?.provider === 'anonymous'))\n\n  const handleDeleteMessage = async (messageId: string) => {\n    try {\n      const response = await fetch(`/api/chat/delete-message?id=${messageId}`, {\n        method: 'DELETE',\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to delete message')\n      }\n\n      setMessages((prev) => prev.filter((msg) => msg.id !== messageId))\n    } catch (err) {\n      try { console.error('Error deleting message:', err) } catch { }\n    }\n  }\n  const handleReaction = async (messageId: string, emoji: string) => {\n    if (!currentUser) {\n      pushSystemMessage('Create an account to react to messages')\n      return\n    }\n\n    // Optimistic update\n    setMessages((prev) => prev.map((msg) => {\n      if (msg.id === messageId) {\n        const existing = msg.reactions?.find(r => r.user_id === currentUser.id && r.emoji === emoji)\n        const newReactions = existing\n          ? msg.reactions?.filter(r => !(r.user_id === currentUser.id && r.emoji === emoji))\n          : [...(msg.reactions || []), { emoji, user_id: currentUser.id }]\n        return { ...msg, reactions: newReactions }\n      }\n      return msg\n    }))\n\n    try {\n      // Check if reaction exists\n      const { data: existing } = await supabase\n        .from('reactions')\n        .select('id')\n        .eq('message_id', messageId)\n        .eq('user_id', currentUser.id)\n        .eq('emoji', emoji)\n        .single()\n\n      if (existing) {\n        await supabase.from('reactions').delete().eq('id', existing.id)\n      } else {\n        await supabase.from('reactions').insert({\n          message_id: messageId,\n          user_id: currentUser.id,\n          emoji\n        })\n      }\n    } catch (err) {\n      console.error('Error toggling reaction:', err)\n    }\n  }\n\n  const toggleMessageSelection = (messageId: string) => {\n    setSelectedMessageIds(prev => {\n      const next = new Set(prev)\n      if (next.has(messageId)) {\n        next.delete(messageId)\n      } else {\n        next.add(messageId)\n      }\n      return next\n    })\n  }\n\n  const handleBulkDelete = async () => {\n    if (selectedMessageIds.size === 0) return\n    if (!confirm(`Delete ${selectedMessageIds.size} messages?`)) return\n\n    const ids = Array.from(selectedMessageIds)\n    try {\n      await Promise.all(ids.map(id =>\n        fetch(`/api/chat/delete-message?id=${id}`, { method: 'DELETE' })\n      ))\n\n      setMessages(prev => prev.filter(m => !selectedMessageIds.has(m.id)))\n      setSelectedMessageIds(new Set())\n      setSelectionMode(false)\n    } catch (err) {\n      alert('Failed to delete some messages')\n    }\n  }\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault()\n      lastInputEventTimeRef.current = performance.now()\n      handleSendMessage()\n    }\n  }\n\n  const formatTimestamp = (timestamp: string) => {\n    const date = new Date(timestamp)\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\n  }\n\n  useEffect(() => {\n    if (currentUser && !sending && !uploadingMedia) {\n      try { messageInputRef.current?.focus() } catch { }\n    }\n  }, [currentUser, sending, uploadingMedia])\n\n  useEffect(() => {\n    const id = setInterval(() => {\n      const mem: any = (performance as any).memory\n      if (mem) {\n        try {\n          console.log('memory_mb', Math.round(mem.usedJSHeapSize / 1048576))\n        } catch { }\n      }\n    }, 5000)\n    return () => clearInterval(id)\n  }, [])\n\n  const getAvatar = (message: Message) => {\n    if (message.profiles?.avatar_url) {\n      return message.profiles.avatar_url\n    }\n    const username = message.profiles?.username || message.user_id || 'user'\n    if (username.startsWith('Guest')) return ''\n    return `https://api.dicebear.com/7.x/avataaars/svg?seed=${username}`\n  }\n\n  const getSenderName = (message: Message) => {\n    return message.profiles?.username || 'Anonymous'\n  }\n\n  const emojis = ['üòä', 'üòÇ', 'üéâ', '‚ù§Ô∏è', 'üî•', 'üëç', 'üéÆ', 'üéµ', '‚ú®', 'üíØ']\n\n  if (loading) {\n    return (\n      <div className=\"h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mx-auto mb-4\" />\n          <p className=\"text-foreground/60\">Loading chat room...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (!room) {\n    return (\n      <div className=\"h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <p className=\"text-foreground/60 mb-4\">Room not found</p>\n          <Link href=\"/\">\n            <Button>Go Home</Button>\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"fixed inset-0 flex flex-col bg-background overflow-hidden overscroll-none\">\n      {/* Header - Mobile responsive */}\n      <header className=\"border-b border-border flex-shrink-0 z-40 bg-background/95 backdrop-blur-sm\">\n        <div className=\"max-w-6xl mx-auto px-2 sm:px-4 py-2 sm:py-4 flex items-center justify-between gap-1.5 sm:gap-2\">\n          <div className=\"flex items-center gap-1.5 sm:gap-4 min-w-0 flex-1\">\n            <Link href=\"/\" className=\"hover:opacity-70 transition-opacity flex-shrink-0\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-background/50 backdrop-blur rounded-xl flex items-center justify-center text-foreground sm:hidden border border-border/50\">\n                  <ChevronLeft className=\"w-5 h-5\" />\n                </div>\n                <h1 className=\"hidden sm:block text-xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent\">\n                  Chat2077\n                </h1>\n              </div>\n            </Link>\n            <div className=\"hidden sm:flex items-center gap-2 pl-4 border-l border-border\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-primary to-secondary rounded-2xl flex items-center justify-center text-lg sm:text-xl flex-shrink-0\">\n                {room.emoji || 'üí¨'}\n              </div>\n              <div className=\"min-w-0\">\n                <h2 className=\"font-bold text-base sm:text-lg truncate\">{room.name}</h2>\n                <p className=\"text-xs text-foreground/60 truncate\">{room.topic}</p>\n              </div>\n            </div>\n            {/* Mobile room info */}\n            <div className=\"sm:hidden flex items-center gap-2 min-w-0 flex-1\">\n              <div className=\"w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center text-sm flex-shrink-0 shadow-sm\">\n                {room.emoji || 'üí¨'}\n              </div>\n              <div className=\"min-w-0 flex flex-col\">\n                <h2 className=\"font-bold text-sm truncate leading-tight\">{room.name}</h2>\n                <p className=\"text-[10px] text-muted-foreground truncate leading-tight\">\n                  {room.member_count || 0} online\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-0.5 sm:gap-2 flex-shrink-0\">\n            <ThemeToggle />\n            <NotificationsPopover />\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"rounded-full\"\n              onClick={() => setSelectionMode(!selectionMode)}\n              title={selectionMode ? \"Cancel Selection\" : \"Select Messages\"}\n            >\n              {selectionMode ? <X className=\"w-5 h-5\" /> : <Check className=\"w-5 h-5\" />}\n            </Button>\n            {selectionMode && selectedMessageIds.size > 0 && (\n              <Button\n                variant=\"destructive\"\n                size=\"icon\"\n                className=\"rounded-full\"\n                onClick={handleBulkDelete}\n                title=\"Delete Selected\"\n              >\n                <Trash2 className=\"w-5 h-5\" />\n              </Button>\n            )}\n            {process.env.NODE_ENV === 'development' && latencies.length > 0 && (\n              <div className=\"ml-1 sm:ml-2 px-2 py-1 rounded-full text-xs bg-primary/10 text-foreground/70\">\n                {`avg ${Math.round(latencies.reduce((a, b) => a + b, 0) / latencies.length)}ms`}\n                {` ‚Ä¢ max ${Math.max(...latencies)}ms`}\n                {` ‚Ä¢ out ${latencies.filter((l) => l > (latencies.reduce((a, b) => a + b, 0) / latencies.length) * 1.7).length}`}\n              </div>\n            )}\n            <div className=\"relative\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"rounded-full h-8 w-8 sm:h-10 sm:w-10\"\n                onClick={() => setShowRoomMenu(!showRoomMenu)}\n              >\n                <MoreVertical className=\"w-3.5 h-3.5 sm:w-5 sm:h-5\" />\n              </Button>\n              {currentUser && (\n                <Button variant=\"outline\" size=\"sm\" className=\"rounded-full ml-1\" onClick={handleLeaveRoom}>\n                  Leave\n                </Button>\n              )}\n              {showRoomMenu && isRoomOwner && (\n                <>\n                  <div\n                    className=\"fixed inset-0 z-[5] bg-background/20\"\n                    onClick={() => setShowRoomMenu(false)}\n                  />\n                  <div className=\"absolute right-0 top-12 bg-card border border-border rounded-lg shadow-lg p-1 z-10 min-w-[200px]\">\n                    <Link href={`/room/${roomId}/edit`}>\n                      <button className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-accent active:bg-accent/80 rounded-md transition-colors\">\n                        <Edit className=\"w-4 h-4\" />\n                        Edit Room\n                      </button>\n                    </Link>\n                    <button\n                      onClick={() => { setShowAddFriends((v) => !v); if (!showAddFriends) loadFriends() }}\n                      className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-primary/10 active:bg-primary/20 rounded-md transition-colors\"\n                    >\n                      Add Friends\n                    </button>\n                    <button\n                      onClick={handleCreateInvite}\n                      className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-primary/10 active:bg-primary/20 rounded-md transition-colors\"\n                      disabled={inviteCreating}\n                    >\n                      <Copy className=\"w-4 h-4\" />\n                      {inviteCreating ? 'Creating‚Ä¶' : 'Create Invite Link'}\n                    </button>\n                    <button\n                      onClick={() => {\n                        setShowRoomMenu(false)\n                        handleDeleteRoom()\n                      }}\n                      className=\"w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-destructive/10 active:bg-destructive/20 text-destructive rounded-md transition-colors\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                      Delete Room\n                    </button>\n                    {inviteError && (\n                      <div className=\"px-3 py-2 text-xs text-destructive\">{inviteError}</div>\n                    )}\n                    {showAddFriends && (\n                      <div className=\"p-2 border-t mt-1\">\n                        <div className=\"text-xs mb-2\">Select friends to add</div>\n                        <div className=\"space-y-2 max-h-40 overflow-auto pr-1\">\n                          {friends.length === 0 ? (\n                            <p className=\"text-xs text-foreground/60\">No accepted friends found.</p>\n                          ) : (\n                            friends.map((f) => (\n                              <div key={f.id || f.friend_id} className=\"flex items-center justify-between text-xs\">\n                                <span>{f.display_name || f.username || 'Friend'}</span>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  className=\"rounded-full h-7\"\n                                  onClick={async () => {\n                                    const uid = f.id || f.friend_id\n                                    if (!uid || !roomId) return\n                                    try {\n                                      await supabase.from('room_members').insert({ room_id: roomId, user_id: uid })\n                                    } catch { }\n                                  }}\n                                >\n                                  Add\n                                </Button>\n                              </div>\n                            ))\n                          )}\n                        </div>\n                      </div>\n                    )}\n                    {inviteToken && (\n                      <div className=\"p-2\">\n                        <div className=\"text-xs mb-1\">Invite Link</div>\n                        <div className=\"flex items-center gap-2\">\n                          <Input readOnly value={`${typeof window !== 'undefined' ? window.location.origin : ''}/room/${roomId}?token=${inviteToken}`} />\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"rounded-full\"\n                            onClick={() => {\n                              const url = `${typeof window !== 'undefined' ? window.location.origin : ''}/room/${roomId}?token=${inviteToken}`\n                              navigator.clipboard.writeText(url).catch(() => { })\n                            }}\n                          >\n                            Copy\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <Dialog.Root open={showAddFriends} onOpenChange={(o) => { setShowAddFriends(!!o) }}>\n        <Dialog.Portal>\n          <Dialog.Overlay className=\"fixed inset-0 bg-background/50 backdrop-blur-sm z-[60]\" />\n          <Dialog.Content className=\"fixed z-[61] left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90vw] max-w-md rounded-xl border border-border bg-card p-4 shadow-lg\">\n            <Dialog.Title className=\"font-semibold text-base\">Add Friends</Dialog.Title>\n            <Dialog.Description className=\"text-xs text-foreground/60 mb-3\">Select friends to add to this private room.</Dialog.Description>\n            <Input\n              placeholder=\"Search friends...\"\n              value={friendSearch}\n              onChange={(e) => setFriendSearch(e.target.value)}\n              className=\"mb-2\"\n            />\n            {friends.length > 0 && (\n              <div className=\"flex items-center justify-between mb-2\">\n                <label className=\"flex items-center gap-2 text-xs\">\n                  <input\n                    type=\"checkbox\"\n                    checked={friends.filter((f: any) => (f.display_name || f.username || '').toLowerCase().includes(friendSearch.toLowerCase())).every((f: any) => selectedFriendIds.includes(f.id || f.friend_id || f.user_id)) && friends.filter((f: any) => (f.display_name || f.username || '').toLowerCase().includes(friendSearch.toLowerCase())).length > 0}\n                    onChange={(e) => {\n                      const filtered = friends.filter((f: any) => (f.display_name || f.username || '').toLowerCase().includes(friendSearch.toLowerCase()))\n                      const ids = filtered.map((f: any) => f.id || f.friend_id || f.user_id)\n                      if (e.target.checked) {\n                        setSelectedFriendIds((prev) => Array.from(new Set([...prev, ...ids])))\n                      } else {\n                        setSelectedFriendIds((prev) => prev.filter((x) => !ids.includes(x)))\n                      }\n                    }}\n                  />\n                  Select All\n                </label>\n                <Button variant=\"outline\" size=\"sm\" className=\"rounded-full h-7\" onClick={() => setSelectedFriendIds([])}>Select None</Button>\n              </div>\n            )}\n            <div className=\"space-y-2 max-h-56 overflow-auto pr-1\">\n              {friends.length === 0 ? (\n                <p className=\"text-xs text-foreground/60\">No accepted friends found.</p>\n              ) : (\n                friends\n                  .filter((f) => (f.display_name || f.username || '').toLowerCase().includes(friendSearch.toLowerCase()))\n                  .map((f) => {\n                    const id = f.id || f.friend_id\n                    const name = f.display_name || f.username || 'Friend'\n                    const checked = selectedFriendIds.includes(id)\n                    return (\n                      <label key={id} className=\"flex items-center gap-3 text-sm\">\n                        <img src={f.avatar_url || '/placeholder.svg'} alt={name} className=\"w-6 h-6 rounded-full\" />\n                        <input\n                          type=\"checkbox\"\n                          checked={checked}\n                          onChange={(e) => {\n                            setSelectedFriendIds((prev) => e.target.checked ? [...prev, id] : prev.filter((x) => x !== id))\n                          }}\n                        />\n                        {name}\n                      </label>\n                    )\n                  })\n              )}\n            </div>\n            <div className=\"mt-4 flex items-center justify-end gap-2\">\n              <Dialog.Close asChild>\n                <Button variant=\"outline\" size=\"sm\" className=\"rounded-full\">Cancel</Button>\n              </Dialog.Close>\n              <Button size=\"sm\" className=\"rounded-full bg-primary\" onClick={handleAddSelectedFriends} loading={addingFriends}>Add Selected</Button>\n            </div>\n          </Dialog.Content>\n        </Dialog.Portal>\n      </Dialog.Root>\n\n\n\n      {/* Messages Container - Mobile responsive */}\n      <div ref={messagesContainerRef} className=\"flex-1 min-h-0 overflow-y-auto p-1.5 sm:p-4 md:p-6 space-y-1 sm:space-y-4\">\n        <div\n          className=\"max-w-4xl mx-auto\"\n          onClick={(e) => {\n            const target = e.target as HTMLElement\n            const actionEl = target.closest('[data-action]') as HTMLElement | null\n            if (actionEl) {\n              const action = actionEl.getAttribute('data-action')\n              const id = actionEl.getAttribute('data-message-id')\n              if (action === 'delete' && id) {\n                handleDeleteMessage(id)\n              }\n            }\n          }}\n        >\n          {messages.length === 0 ? (\n            <div className=\"text-center py-8 sm:py-12\">\n              <p className=\"text-foreground/60 text-sm sm:text-base\">No messages yet. Be the first to say something!</p>\n            </div>\n          ) : (\n            (() => {\n              const start = Math.max(0, messages.length - visibleCount)\n              const visible = messages.slice(start)\n              return (\n                <>\n                  {start > 0 && (\n                    <div className=\"flex justify-center py-2\">\n                      <Button variant=\"outline\" size=\"sm\" className=\"rounded-full\" onClick={() => setVisibleCount((c) => c + 200)}>\n                        Load older messages\n                      </Button>\n                    </div>\n                  )}\n                  {visible.map((msg, index) => (\n                    <ChatBubble\n                      key={msg.id}\n                      message={msg.content}\n                      sender={getSenderName(msg)}\n                      avatar={getAvatar(msg)}\n                      showAvatar={!selectionMode && (index === 0 || messages[index - 1].user_id !== msg.user_id)}\n                      isOwn={currentUser && msg.user_id === currentUser.id}\n                      timestamp={formatTimestamp(msg.created_at)}\n                      reactions={msg.reactions?.reduce((acc: { emoji: string; count: number }[], curr) => {\n                        const existing = acc.find(r => r.emoji === curr.emoji)\n                        if (existing) existing.count++\n                        else acc.push({ emoji: curr.emoji, count: 1 })\n                        return acc\n                      }, [])}\n                      messageId={msg.id}\n                      onDelete={handleDeleteMessage}\n                      mediaUrl={msg.media_url}\n                      mediaType={msg.media_type}\n                      onReaction={(emoji) => handleReaction(msg.id, emoji)}\n                      onReply={(replyMsg) => setInputValue(`Replying to ${replyMsg.sender}: `)}\n                      selectionMode={selectionMode}\n                      isSelected={selectedMessageIds.has(msg.id)}\n                      onSelect={() => toggleMessageSelection(msg.id)}\n                    />\n                  ))}\n                </>\n              )\n            })()\n          )}\n          {currentUser && <TypingIndicator roomId={roomId} currentUserId={currentUser.id} />}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* Input Section - Mobile responsive */}\n      {!currentUser ? (\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\n          <Card className=\"w-full max-w-sm bg-card border-border p-4 sm:p-6 text-center\">\n            <p className=\"text-foreground/60 mb-2 text-sm sm:text-base\">Sign in or continue as a guest user.</p>\n            <div className=\"flex flex-col sm:flex-row items-center justify-center gap-2\">\n              <Link href=\"/auth\">\n                <Button size=\"sm\" className=\"w-full sm:w-auto h-9 rounded-full\">Sign In</Button>\n              </Link>\n              <Link href=\"/guest\">\n                <Button variant=\"outline\" size=\"sm\" className=\"w-full sm:w-auto h-9 rounded-full\">\n                  <MessageCircle className=\"w-4 h-4 mr-2\" />\n                  Join as Guest\n                </Button>\n              </Link>\n            </div>\n          </Card>\n        </div>\n      ) : (\n        <div className=\"border-t border-border bg-background sticky bottom-0 p-2 sm:p-4 md:p-6\">\n          <div className=\"max-w-4xl mx-auto\">\n            {/* Emoji Picker */}\n            {showEmojiPicker && (\n              <Card className=\"mb-2 sm:mb-4 p-2 sm:p-4 bg-card\">\n                <div className=\"grid grid-cols-6 sm:grid-cols-5 gap-1.5 sm:gap-2\">\n                  {emojis.map((emoji) => (\n                    <button\n                      key={emoji}\n                      onClick={() => {\n                        setInputValue(inputValue + emoji)\n                        setShowEmojiPicker(false)\n                      }}\n                      className=\"text-xl sm:text-2xl hover:scale-125 transition-transform p-1 sm:p-2\"\n                    >\n                      {emoji}\n                    </button>\n                  ))}\n                </div>\n              </Card>\n            )}\n\n            {/* Selected File Preview */}\n            {selectedFile && (\n              <div className=\"mb-2 relative inline-block\">\n                <div className=\"relative w-20 h-20 sm:w-24 sm:h-24 rounded-lg overflow-hidden border border-border\">\n                  <img\n                    src={URL.createObjectURL(selectedFile)}\n                    alt=\"Preview\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                  <button\n                    onClick={() => {\n                      setSelectedFile(null)\n                      if (fileInputRef.current) fileInputRef.current.value = ''\n                    }}\n                    className=\"absolute top-1 right-1 bg-destructive text-destructive-foreground rounded-full p-1 hover:bg-destructive/90\"\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </button>\n                </div>\n              </div>\n            )}\n\n            {/* Input Field - Mobile responsive */}\n            <div className=\"flex gap-1 sm:gap-2 items-end\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={handleFileSelect}\n                className=\"hidden\"\n              />\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"rounded-full h-8 w-8 sm:h-10 sm:w-10\"\n                onClick={() => setShowEmojiPicker(!showEmojiPicker)}\n              >\n                <Smile className=\"w-3.5 h-3.5 sm:w-5 sm:h-5\" />\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"rounded-full h-8 w-8 sm:h-10 sm:w-10\"\n                onClick={() => { if (isGuestUser) { pushSystemMessage('Create an account to upload images'); } else { fileInputRef.current?.click() } }}\n                disabled={uploadingMedia}\n              >\n                <Paperclip className=\"w-3.5 h-3.5 sm:w-5 sm:h-5\" />\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"rounded-full h-8 w-8 sm:h-10 sm:w-10\"\n                onClick={() => setShowGiphyPicker(true)}\n                title=\"Send GIF\"\n              >\n                <ImageIconLucide className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n              </Button>\n              <Input\n                placeholder=\"Type a message...\"\n                value={inputValue}\n                onChange={(e) => {\n                  setInputValue(e.target.value)\n                  broadcastTyping(e.target.value.length > 0)\n                  if (e.target.value.length === 0) {\n                    setTimeout(() => broadcastTyping(false), 500)\n                  }\n                }}\n                onKeyDown={handleKeyDown}\n                autoFocus\n                ref={messageInputRef}\n                className=\"rounded-full px-3 sm:px-6 py-1.5 sm:py-2 text-xs sm:text-base flex-1 min-w-0 h-8 sm:h-10\"\n              />\n              <Button\n                onMouseDown={(e) => e.preventDefault()}\n                onClick={() => {\n                  lastInputEventTimeRef.current = performance.now()\n                  handleSendMessage()\n                }}\n                className=\"bg-primary hover:bg-primary/90 rounded-full h-8 w-8 sm:h-10 sm:w-10 flex-shrink-0\"\n                size=\"icon\"\n                disabled={sending || uploadingMedia || (!inputValue.trim() && !selectedFile)}\n                loading={sending || uploadingMedia}\n              >\n                {uploadingMedia ? (\n                  <div className=\"w-3.5 h-3.5 sm:w-5 sm:h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                ) : (\n                  <SendHorizontal className=\"w-3.5 h-3.5 sm:w-5 sm:h-5\" />\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Giphy Picker */}\n      <GiphyPicker\n        open={showGiphyPicker}\n        onOpenChange={setShowGiphyPicker}\n        onSelect={handleGifSelect}\n      />\n\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}