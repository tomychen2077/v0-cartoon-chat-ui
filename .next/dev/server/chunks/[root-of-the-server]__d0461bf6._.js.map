{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/lib/supabase/admin.ts"],"sourcesContent":["import { createClient as createSupabaseClient } from '@supabase/supabase-js'\n\nexport function createAdminClient() {\n  return createSupabaseClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: { autoRefreshToken: false, persistSession: false },\n    }\n  )\n}\n\n"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,yMAAoB,gFAEzB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YAAE,kBAAkB;YAAO,gBAAgB;QAAM;IACzD;AAEJ"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bkbil/OneDrive/Documents/GitHub/v0-cartoon-chat-ui/app/api/room-members/cleanup/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createAdminClient } from '@/lib/supabase/admin'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const admin = createAdminClient()\n\n    const url = new URL(request.url)\n    const minutesParam = url.searchParams.get('minutes')\n    const tokenParam = url.searchParams.get('token')\n    const expected = process.env.CRON_SECRET\n    const isDev = process.env.NODE_ENV === 'development'\n    if (!isDev) {\n      if (!expected || tokenParam !== expected) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n      }\n    }\n    const minutes = Math.max(1, Number(minutesParam || 2))\n    const cutoff = new Date(Date.now() - minutes * 60_000).toISOString()\n\n    let error: any = null\n    const { error: err1 } = await admin\n      .from('room_members')\n      .delete()\n      .lt('last_seen', cutoff)\n    error = err1\n\n    if (error) {\n      await admin\n        .from('room_members')\n        .delete()\n        .lt('joined_at', cutoff)\n    }\n\n    return NextResponse.json({ success: true })\n  } catch (e) {\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,QAAQ,IAAA,+IAAiB;QAE/B,MAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;QAC/B,MAAM,eAAe,IAAI,YAAY,CAAC,GAAG,CAAC;QAC1C,MAAM,aAAa,IAAI,YAAY,CAAC,GAAG,CAAC;QACxC,MAAM,WAAW,QAAQ,GAAG,CAAC,WAAW;QACxC,MAAM,QAAQ,oDAAyB;QACvC;;QAKA,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,OAAO,gBAAgB;QACnD,MAAM,SAAS,IAAI,KAAK,KAAK,GAAG,KAAK,UAAU,QAAQ,WAAW;QAElE,IAAI,QAAa;QACjB,MAAM,EAAE,OAAO,IAAI,EAAE,GAAG,MAAM,MAC3B,IAAI,CAAC,gBACL,MAAM,GACN,EAAE,CAAC,aAAa;QACnB,QAAQ;QAER,IAAI,OAAO;YACT,MAAM,MACH,IAAI,CAAC,gBACL,MAAM,GACN,EAAE,CAAC,aAAa;QACrB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,GAAG;QACV,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}