module.exports=[80830,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(69240),e=a.i(40695),f=a.i(3130),g=a.i(5522),h=a.i(76472),i=a.i(70106);let j=(0,i.default)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),k=(0,i.default)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),l=(0,i.default)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),m=(0,i.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var n=a.i(20005),o=a.i(45222),p=a.i(17371);let q=(0,i.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var r=a.i(33508);let s=(0,i.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var t=a.i(60246);let u=(0,i.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),v=(0,i.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var w=a.i(38246),x=a.i(50944);function y({initialProfile:a,userId:i}){let[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(a),[C,D]=(0,c.useState)(a?.avatar_url||""),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)([]),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)([]),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)(!1),U=(0,c.useRef)(null),V=(0,c.useRef)(null),W=(0,x.useRouter)(),X=(0,d.createClient)(),[Y,Z]=(0,c.useState)(!1);(0,c.useEffect)(()=>{$(),_()},[]),(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await X.auth.getUser();Z(!!(a&&(a.is_anonymous||a.app_metadata?.provider==="anonymous")))})()},[X]);let $=async()=>{try{let a=await fetch("/api/friends/get?status=accepted");if(a.ok){let b=await a.json();L(b.friends||[])}}catch(a){console.error("Error loading friends:",a)}},_=async()=>{try{let a=await fetch("/api/friends/get?status=pending");if(a.ok){let b=await a.json();R(b.friends||[])}}catch(a){console.error("Error loading pending requests:",a)}};(0,c.useEffect)(()=>{S&&V.current?.scrollIntoView({behavior:"smooth",block:"start"})},[S]);let aa=async a=>{let b=a.target.files?.[0];if(b){J(!0),F(null);try{let a=new FormData;a.append("file",b);let c=await fetch("/api/profile/upload-avatar",{method:"POST",body:a}),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to upload image");D(d.avatar_url),B({...A,avatar_url:d.avatar_url})}catch(a){F(a instanceof Error?a.message:"Failed to upload image")}finally{J(!1),U.current&&(U.current.value="")}}},ab=async()=>{if(!M.trim())return void P([]);try{let{data:a,error:b}=await X.from("profiles").select("id, username, display_name, avatar_url, bio").neq("id",i).or(`username.ilike.%${M}%,display_name.ilike.%${M}%`).limit(10);if(b)throw b;P(a||[])}catch(a){console.error("Error searching users:",a)}},ac=async a=>{try{F(null);let b=await fetch("/api/friends/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({friend_id:a})}),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to add friend");N(""),P([]),_()}catch(a){F(a instanceof Error?a.message:"Failed to add friend")}},ad=async a=>{try{if(!(await fetch("/api/friends/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({friend_request_id:a})})).ok)throw Error("Failed to accept request");$(),_()}catch(a){F(a instanceof Error?a.message:"Failed to accept request")}},ae=async a=>{if(confirm("Are you sure you want to remove this friend?"))try{if(!(await fetch(`/api/friends/remove?friend_id=${a}`,{method:"DELETE"})).ok)throw Error("Failed to remove friend");$()}catch(a){F(a instanceof Error?a.message:"Failed to remove friend")}},af=async()=>{try{F(null),H(!0);let{error:a}=await X.from("profiles").update({display_name:A.display_name,bio:A.bio,avatar_url:Y?null:C,gender:A.gender,age:A.age??null,updated_at:new Date().toISOString()}).eq("id",i);if(a)throw a;z(!1)}catch(a){F(a instanceof Error?a.message:"Failed to save profile")}finally{H(!1)}},ag=async()=>{try{let{error:a}=await X.auth.signOut();if(a)throw a;W.push("/auth")}catch(a){F(a instanceof Error?a.message:"Failed to logout")}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 dark:from-background dark:via-background dark:to-primary/10",children:[(0,b.jsx)("nav",{className:"sticky top-0 z-50 backdrop-blur-lg border-b border-border",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,b.jsxs)(w.default,{href:"/",className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-accent rounded-2xl flex items-center justify-center text-white font-bold text-xl",children:"ðŸ’¬"}),(0,b.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"ChatBloom"})]}),(0,b.jsxs)(e.Button,{size:"sm",className:"bg-accent hover:bg-accent/90 rounded-full",onClick:ag,children:[(0,b.jsx)(n.LogOut,{className:"w-4 h-4 mr-2"}),"Logout"]})]})}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[E&&(0,b.jsx)(f.Card,{className:"p-4 mb-6 bg-red-500/10 border border-red-500/30",children:(0,b.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:E})}),(0,b.jsxs)("div",{className:"relative mb-12",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/30 via-secondary/30 to-accent/30 rounded-3xl blur-xl"}),(0,b.jsx)(f.Card,{className:"relative p-8 md:p-12 bg-gradient-to-br from-card to-card/50",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-3 gap-8 items-center",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsxs)("div",{className:"relative w-32 h-32 sm:w-40 sm:h-40 rounded-3xl border-4 border-primary/50 overflow-hidden shadow-lg mb-4",children:[Y?(0,b.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-muted to-muted/50"}):(0,b.jsx)("img",{src:C||"/placeholder.svg",alt:"User avatar",className:"w-full h-full object-cover"}),y&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:(0,b.jsx)(e.Button,{size:"icon",variant:"secondary",className:"rounded-full",onClick:()=>U.current?.click(),disabled:I,children:(0,b.jsx)(q,{className:"w-4 h-4"})})})]}),(0,b.jsx)("input",{ref:U,type:"file",accept:"image/*",onChange:aa,className:"hidden"}),y&&!Y&&(0,b.jsxs)("div",{className:"space-y-3 w-full",children:[(0,b.jsx)(e.Button,{size:"sm",variant:"outline",className:"w-full text-xs",onClick:()=>U.current?.click(),disabled:I,children:I?"Uploading...":"Upload Image"}),(0,b.jsx)("p",{className:"text-xs text-foreground/60 text-center",children:"Or choose from presets"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["https://api.dicebear.com/7.x/avataaars/svg?seed=user1","https://api.dicebear.com/7.x/avataaars/svg?seed=user2","https://api.dicebear.com/7.x/avataaars/svg?seed=user3","https://api.dicebear.com/7.x/avataaars/svg?seed=user4","https://api.dicebear.com/7.x/avataaars/svg?seed=user5","https://api.dicebear.com/7.x/avataaars/svg?seed=user6"].map(a=>(0,b.jsx)("button",{onClick:()=>D(a),className:`w-10 h-10 sm:w-12 sm:h-12 rounded-xl border-2 overflow-hidden transition-all ${C===a?"border-primary scale-110":"border-border hover:border-primary/50"}`,children:(0,b.jsx)("img",{src:a||"/placeholder.svg",alt:"Avatar option",className:"w-full h-full"})},a))}),(0,b.jsx)(e.Button,{size:"sm",className:"w-full bg-primary hover:bg-primary/90 rounded-full text-xs sm:text-sm mt-2",onClick:af,disabled:G,children:G?"Saving...":"Save Changes"})]})]}),(0,b.jsx)("div",{className:"md:col-span-2",children:y?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold mb-2 block",children:"Display Name"}),(0,b.jsx)(g.Input,{value:A.display_name||"",onChange:a=>B({...A,display_name:a.target.value}),className:"rounded-lg"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold mb-2 block",children:"Gender"}),(0,b.jsxs)("select",{value:A.gender||"other",onChange:a=>B({...A,gender:a.target.value}),className:"w-full px-3 py-2 rounded-lg border border-border bg-background",children:[(0,b.jsx)("option",{value:"male",children:"Male"}),(0,b.jsx)("option",{value:"female",children:"Female"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold mb-2 block",children:"Age"}),(0,b.jsx)(g.Input,{type:"number",value:A.age||"",onChange:a=>B({...A,age:Number(a.target.value)}),className:"rounded-lg"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-semibold mb-2 block",children:"Bio"}),(0,b.jsx)("textarea",{value:A.bio||"",onChange:a=>B({...A,bio:a.target.value}),className:"w-full px-3 py-2 rounded-lg border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary",rows:3})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(e.Button,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>z(!1),children:"Cancel"})})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-4xl font-bold mb-2",children:A.display_name||A.username}),(0,b.jsx)("p",{className:"text-foreground/70 mb-4",children:A.bio||"No bio yet"}),(0,b.jsxs)("div",{className:"flex gap-4 text-sm text-foreground/70 mb-4",children:[A.gender&&(0,b.jsxs)("span",{children:["Gender: ",A.gender]}),"number"==typeof A.age&&(0,b.jsxs)("span",{children:["Age: ",A.age]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 rounded-full bg-primary/10 text-xs font-semibold",children:[(0,b.jsx)(l,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:["Level ",A.level||1]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 rounded-full bg-accent/10 text-xs font-semibold",children:[(0,b.jsx)(j,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:[(A.xp_points||0).toLocaleString()," XP"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 rounded-full bg-secondary/10 text-xs font-semibold",children:[(0,b.jsx)(k,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:[4," Achievements"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",className:"bg-primary hover:bg-primary/90 rounded-full",onClick:()=>z(!0),children:[(0,b.jsx)(m,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>T(!S),children:[(0,b.jsx)(t.Users,{className:"w-4 h-4 mr-2"}),"Friends (",K.length,")"]})]})]})})]})})]}),(0,b.jsxs)("div",{ref:V,className:"mb-12",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h3",{className:"text-2xl font-bold",children:"Friends"}),(0,b.jsx)(e.Button,{size:"sm",variant:"outline",onClick:()=>T(!S),className:"rounded-full",children:S?(0,b.jsx)(r.X,{className:"w-4 h-4"}):(0,b.jsx)(t.Users,{className:"w-4 h-4"})})]}),S&&(0,b.jsx)(f.Card,{className:"p-4 sm:p-6",children:(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,b.jsx)(g.Input,{placeholder:"Search users by username...",value:M,onChange:a=>N(a.target.value),onKeyPress:a=>"Enter"===a.key&&ab(),className:"flex-1"}),(0,b.jsx)(e.Button,{onClick:ab,className:"rounded-full",children:(0,b.jsx)(s,{className:"w-4 h-4"})})]}),O.length>0&&(0,b.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground/70",children:"Search Results"}),O.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-accent/10 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("img",{src:a.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.username}`,alt:a.username,className:"w-10 h-10 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.display_name||a.username}),(0,b.jsxs)("p",{className:"text-xs text-foreground/60",children:["@",a.username]})]})]}),(0,b.jsx)(e.Button,{size:"sm",onClick:()=>ac(a.id),className:"rounded-full",children:(0,b.jsx)(p.UserPlus,{className:"w-4 h-4"})})]},a.id))]}),Q.length>0&&(0,b.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground/70",children:"Pending Requests"}),Q.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-accent/10 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("img",{src:a.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.username}`,alt:a.username,className:"w-10 h-10 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.display_name||a.username}),(0,b.jsxs)("p",{className:"text-xs text-foreground/60",children:["@",a.username]})]})]}),(0,b.jsx)(e.Button,{size:"sm",onClick:()=>ad(a.id),className:"rounded-full",children:(0,b.jsx)(u,{className:"w-4 h-4"})})]},a.id))]}),K.length>0?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground/70 mb-2",children:"Your Friends"}),(0,b.jsx)("div",{className:"grid sm:grid-cols-2 gap-3",children:K.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-accent/10 rounded-lg",children:[(0,b.jsxs)(w.default,{href:`/profile/${a.friend_id}`,className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("img",{src:a.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.username}`,alt:a.username,className:"w-10 h-10 rounded-full"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.display_name||a.username}),(0,b.jsxs)("p",{className:"text-xs text-foreground/60",children:["@",a.username]})]})]}),(0,b.jsx)(e.Button,{size:"sm",variant:"ghost",onClick:()=>ae(a.friend_id),className:"rounded-full",children:(0,b.jsx)(v,{className:"w-4 h-4 text-destructive"})})]},a.id))})]}):(0,b.jsx)("p",{className:"text-center text-foreground/60 py-8",children:"No friends yet. Search for users to add them!"})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold mb-6",children:"Recent Activity"}),(0,b.jsx)(f.Card,{className:"p-6",children:(0,b.jsx)("div",{className:"space-y-4",children:[{type:"room",text:"Joined ChatBloom",time:"Just now"},{type:"message",text:"Profile created",time:"Just now"},{type:"badge",text:"Welcome to ChatBloom",time:"Just now"},{type:"level",text:"Level 1",time:"Just now"}].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 pb-4 border-b border-border last:border-0 last:pb-0",children:[(0,b.jsxs)("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center",children:["room"===a.type&&(0,b.jsx)(o.MessageCircle,{className:"w-5 h-5 text-primary"}),"message"===a.type&&(0,b.jsx)(h.Heart,{className:"w-5 h-5 text-accent"}),"badge"===a.type&&(0,b.jsx)(k,{className:"w-5 h-5 text-amber-500"}),"level"===a.type&&(0,b.jsx)(j,{className:"w-5 h-5 text-primary"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.text}),(0,b.jsx)("p",{className:"text-xs text-foreground/50",children:a.time})]})]},c))})})]})]})]})}a.s(["default",()=>y],80830)}];

//# sourceMappingURL=components_profile-client_tsx_99262e49._.js.map