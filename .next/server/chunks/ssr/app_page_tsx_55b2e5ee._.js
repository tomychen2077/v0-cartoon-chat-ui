module.exports=[60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(40695),e=a.i(5522),f=a.i(3130),g=a.i(76472),h=a.i(60246),i=a.i(8406),j=a.i(45222),k=a.i(20005),l=a.i(46842);let m=(0,a.i(70106).default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var n=a.i(52025),o=a.i(38246),p=a.i(50944),q=a.i(69240);function r(){let[a,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)("all"),[C,D]=(0,c.useState)("any"),[E,F]=(0,c.useState)("most_active"),G=!!u&&(u.is_anonymous||u.app_metadata?.provider==="anonymous"),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(!1),L=(0,p.useRouter)(),M=(0,q.createClient)(),N=async()=>{I(null),K(!0);try{let{data:a,error:b}=await M.auth.signInAnonymously();if(b){I("Guest sign-in failed. Redirecting to Guest page..."),L.push("/guest");return}let c=a?.user;if(c?.id){let a=`Guest-${Math.floor(1e4*Math.random())}`,b=`https://api.dicebear.com/7.x/avataaars/svg?seed=guest${Math.random()}`;await M.from("profiles").upsert({id:c.id,username:a,display_name:a,avatar_url:b}),v(c)}else I("Guest session unavailable. Use Guest page instead."),L.push("/guest")}catch{I("Unexpected error. Redirecting to Guest page..."),L.push("/guest")}finally{K(!1)}};(0,c.useEffect)(()=>{let b=(0,q.createClient)(),c=async()=>{let{data:{user:a}}=await b.auth.getUser();v(a)};(async()=>{try{let{data:a,error:c}=await b.from("rooms").select(`
            *,
            creator:profiles!rooms_created_by_fkey (
              id,
              username,
              display_name,
              avatar_url
            ),
            room_members (
              user_id,
              profiles (
                id,
                username,
                display_name,
                avatar_url
              )
            )
          `).eq("is_public",!0).limit(50);if(c)throw c;let d=(a||[]).map(a=>{let b=a.room_members?.slice(0,4).map(a=>a.profiles).filter(Boolean)||[],c=Array.isArray(a.room_members)?a.room_members.length:b.length,d=a.creator?{id:a.creator.id,username:a.creator.username,display_name:a.creator.display_name,avatar_url:a.creator.avatar_url}:void 0;return{...a,members:b,liveCount:c,creator:d}});r(d)}catch(a){console.error("Failed to fetch rooms:",a),r([{id:"1",name:"General Chat",description:"",topic:"General Discussion",emoji:"ðŸ’¬",is_public:!0,member_count:2543,max_members:8,members:[]},{id:"2",name:"Gaming Hub",description:"",topic:"Video Games",emoji:"ðŸŽ®",is_public:!0,member_count:1843,max_members:8,members:[]},{id:"3",name:"Creative Corner",description:"",topic:"Art & Design",emoji:"ðŸŽ¨",is_public:!0,member_count:892,max_members:8,members:[]},{id:"4",name:"Tech Talk",description:"",topic:"Technology",emoji:"ðŸ’»",is_public:!0,member_count:1234,max_members:8,members:[]},{id:"5",name:"Music Vibes",description:"",topic:"Music & Podcasts",emoji:"ðŸŽµ",is_public:!0,member_count:567,max_members:8,members:[]},{id:"6",name:"Study Squad",description:"",topic:"Learning Together",emoji:"ðŸ“š",is_public:!0,member_count:3421,max_members:8,members:[]}])}finally{t(!1)}})().then(async()=>{try{let c=(a||[]).map(a=>a.id);if(0===c.length)return;let d=b.channel("rooms-live").on("postgres_changes",{event:"INSERT",schema:"public",table:"room_members"},async a=>{let c=a.new?.room_id,d=a.new?.user_id;c&&d&&r(a=>{let e=a.findIndex(a=>a.id===c);if(-1===e)return a;let f=a[e],g=f.members?.some(a=>a?.id===d||a?.user_id===d);return f.members&&[...f.members],g||b.from("profiles").select("id, username, display_name, avatar_url").eq("id",d).single().then(({data:a})=>{a&&r(b=>{let d=b.findIndex(a=>a.id===c);if(-1===d)return b;let e=b[d],f=e.members?[...e.members]:[];return f.some(b=>b.id===a.id)||f.unshift({id:a.id,username:a.username,display_name:a.display_name,avatar_url:a.avatar_url}),[...b.slice(0,d),{...e,members:f.slice(0,4),liveCount:(e.liveCount||0)+1},...b.slice(d+1)]})}),[...a.slice(0,e),{...f,liveCount:(f.liveCount||0)+ +!g},...a.slice(e+1)]})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"room_members"},async a=>{let b=a.old?.room_id,c=a.old?.user_id;b&&c&&r(a=>{let d=a.findIndex(a=>a.id===b);if(-1===d)return a;let e=a[d],f=(e.members||[]).filter(a=>a.id!==c&&a.user_id!==c),g=Math.max(0,(e.liveCount||0)-1);return[...a.slice(0,d),{...e,members:f,liveCount:g},...a.slice(d+1)]})}).subscribe();return()=>{b.removeChannel(d)}}catch{}}),c();let{data:{subscription:d}}=b.auth.onAuthStateChange((a,b)=>{v(b?.user??null)});return()=>{d.unsubscribe()}},[]);let O=async()=>{try{let a=(0,q.createClient)(),{error:b}=await a.auth.signOut();if(b)throw b;L.push("/")}catch(a){console.error("Failed to sign out:",a)}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 dark:from-background dark:via-background dark:to-primary/10",children:[(0,b.jsx)("nav",{className:"sticky top-0 z-50 backdrop-blur-lg border-b border-border",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-accent rounded-2xl flex items-center justify-center text-white font-bold text-xl",children:"ðŸ’¬"}),(0,b.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"ChatBloom"})]}),(0,b.jsxs)("div",{className:"hidden sm:flex gap-3 items-center",children:[(0,b.jsx)(n.ThemeToggle,{}),u&&!G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.default,{href:"/profile",children:(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",className:"rounded-full",children:[(0,b.jsx)(l.User,{className:"w-4 h-4 mr-2"}),"Profile"]})}),(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:O,className:"rounded-full",children:[(0,b.jsx)(k.LogOut,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]}):(0,b.jsx)(o.default,{href:"/auth",children:(0,b.jsx)(d.Button,{variant:"outline",size:"sm",className:"rounded-full",children:"Sign In"})}),!G&&(0,b.jsx)(o.default,{href:"/create-room",children:(0,b.jsx)(d.Button,{size:"sm",className:"bg-accent hover:bg-accent/90 rounded-full",children:"Create Room"})})]}),(0,b.jsxs)("div",{className:"sm:hidden flex items-center gap-2",children:[(0,b.jsx)(n.ThemeToggle,{}),(0,b.jsx)(d.Button,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>x(a=>!a),children:(0,b.jsx)(m,{className:"w-4 h-4"})})]})]})}),w&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 z-[45] bg-background/40",onClick:()=>x(!1)}),(0,b.jsx)("div",{className:"fixed top-14 left-0 right-0 z-[50] px-3",children:(0,b.jsxs)("div",{className:"bg-card border border-border rounded-2xl shadow-lg p-3 grid grid-cols-1 gap-2",children:[u&&!G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.default,{href:"/profile",onClick:()=>x(!1),children:(0,b.jsxs)(d.Button,{variant:"outline",className:"w-full rounded-full justify-start",children:[(0,b.jsx)(l.User,{className:"w-4 h-4 mr-2"})," Profile"]})}),(0,b.jsxs)(d.Button,{variant:"outline",className:"w-full rounded-full justify-start",onClick:()=>{x(!1),O()},children:[(0,b.jsx)(k.LogOut,{className:"w-4 h-4 mr-2"})," Sign Out"]})]}):(0,b.jsx)(o.default,{href:"/auth",onClick:()=>x(!1),children:(0,b.jsx)(d.Button,{variant:"outline",className:"w-full rounded-full justify-start",children:"Sign In"})}),!G&&(0,b.jsx)(o.default,{href:"/create-room",onClick:()=>x(!1),children:(0,b.jsx)(d.Button,{className:"w-full rounded-full bg-accent hover:bg-accent/90 justify-start",children:"Create Room"})})]})})]}),(0,b.jsxs)("section",{className:"relative overflow-hidden",children:[(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-12 md:py-24",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-12 items-center",children:[(0,b.jsxs)("div",{className:"space-y-8 text-center md:text-left",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("h2",{className:"text-4xl sm:text-5xl md:text-6xl font-bold leading-tight",children:[(0,b.jsx)("span",{className:"text-balance",children:"Connect, Chat &"}),(0,b.jsx)("span",{className:"block bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"Celebrate Together"})]}),(0,b.jsx)("p",{className:"text-lg text-foreground/70 leading-relaxed max-w-none sm:max-w-lg mx-auto md:mx-0",children:"Join vibrant chat rooms, connect with friends 1-on-1, and earn rewards as you grow. Experience chatting reimagined with a fun, cartoon-style interface."})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center md:justify-start",children:[(0,b.jsx)(o.default,{href:"/create-room",children:(0,b.jsxs)(d.Button,{size:"lg",className:"bg-primary hover:bg-primary/90 rounded-full font-semibold px-8 w-full",children:[(0,b.jsx)(i.Sparkles,{className:"w-5 h-5 mr-2"}),"Create Room"]})}),(0,b.jsxs)(d.Button,{size:"lg",variant:"outline",className:"rounded-full font-semibold px-8 w-full",onClick:N,disabled:J,children:[(0,b.jsx)(j.MessageCircle,{className:"w-5 h-5 mr-2"}),J?"Startingâ€¦":"Join as Guest"]}),H&&(0,b.jsx)("p",{className:"mt-2 text-xs text-foreground/60",children:H})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 pt-4",children:[(0,b.jsxs)("div",{className:"bg-primary/10 dark:bg-primary/20 rounded-2xl p-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-primary",children:"Hello  "}),(0,b.jsx)("p",{className:"text-sm text-foreground/70",children:"Users"})]}),(0,b.jsxs)("div",{className:"bg-accent/10 dark:bg-accent/20 rounded-2xl p-4",children:[(0,b.jsxs)("p",{className:"text-2xl font-bold text-accent",children:[a.length,"+"]}),(0,b.jsx)("p",{className:"text-sm text-foreground/70",children:"Chat Rooms"})]})]})]}),(0,b.jsxs)("div",{className:"relative h-72 md:h-full hidden md:block",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-accent/20 rounded-3xl blur-2xl"}),(0,b.jsx)("div",{className:"relative flex items-center justify-center h-full",children:(0,b.jsx)("div",{className:"w-56 h-56 md:w-64 md:h-64 bg-gradient-to-br from-primary via-secondary to-accent rounded-3xl shadow-2xl flex items-center justify-center animate-float",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-5xl md:text-6xl mb-2 md:mb-4",children:"ðŸ’¬"}),(0,b.jsx)("p",{className:"text-white font-bold text-base md:text-lg",children:"Chat Magic"})]})})})]})]})}),(0,b.jsx)("div",{className:"hidden md:block absolute top-20 left-10 w-20 h-20 bg-primary/20 rounded-full blur-xl animate-float",style:{animationDelay:"0s"}}),(0,b.jsx)("div",{className:"hidden md:block absolute bottom-20 right-10 w-32 h-32 bg-accent/20 rounded-full blur-xl animate-float",style:{animationDelay:"1s"}}),(0,b.jsx)("div",{className:"hidden md:block absolute top-1/2 right-1/4 w-24 h-24 bg-secondary/20 rounded-full blur-xl animate-float",style:{animationDelay:"2s"}})]}),(0,b.jsx)("section",{className:"py-20 border-t border-border",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,b.jsxs)("div",{className:"mb-12",children:[(0,b.jsx)("h3",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Explore Chat Rooms"}),(0,b.jsx)("p",{className:"text-foreground/60",children:"Find rooms by name, topic, and availability"}),(0,b.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(e.Input,{placeholder:"Search rooms by name or topic",value:y,onChange:a=>z(a.target.value),className:"rounded-full h-10 text-sm flex-1"})}),(0,b.jsxs)("div",{className:"flex gap-2 overflow-x-auto whitespace-nowrap py-1 -mx-1 px-1",children:[(0,b.jsx)(d.Button,{variant:"any"===C?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>D("any"),children:"Any"}),(0,b.jsx)(d.Button,{variant:"available"===C?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>D("available"),children:"Available"}),(0,b.jsx)(d.Button,{variant:"full"===C?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>D("full"),children:"Full"})]}),(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto whitespace-nowrap py-1 -mx-1 px-1",children:["all","General","Gaming","Art & Design","Technology","Music","Learning","Sports","Food"].map(a=>(0,b.jsx)(d.Button,{variant:A===a?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>B(a),children:"all"===a?"All Topics":a},a))}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(d.Button,{variant:"most_active"===E?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>F("most_active"),children:"Most Active"}),(0,b.jsx)(d.Button,{variant:"alphabetical"===E?"default":"outline",size:"sm",className:"rounded-full px-3",onClick:()=>F("alphabetical"),children:"Aâ€“Z"})]})]})]}),s?(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mx-auto"})}):(0,b.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:a.filter(a=>{let b=y.trim().toLowerCase(),c=""===b||a.name.toLowerCase().includes(b)||(a.topic||"").toLowerCase().includes(b),d="all"===A||(a.topic||"").toLowerCase()===A.toLowerCase(),e=(a.max_members??8)-(a.liveCount??0)>0;return c&&d&&("any"===C||("available"===C?e:!e))}).sort((a,b)=>"alphabetical"===E?a.name.localeCompare(b.name):(b.liveCount??0)-(a.liveCount??0)).map(a=>(0,b.jsxs)(f.Card,{onClick:()=>L.push(`/room/${a.id}`),className:"p-4 sm:p-6 hover:shadow-lg hover:shadow-primary/20 transition-all duration-300 cursor-pointer group border-border/50 hover:border-primary/50 h-full",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3 sm:mb-4",children:[(0,b.jsx)("div",{className:"text-3xl sm:text-5xl",children:a.emoji}),(0,b.jsxs)("div",{className:"bg-primary/10 dark:bg-primary/20 text-primary rounded-full px-2 sm:px-3 py-1 text-xs sm:text-sm font-semibold group-hover:scale-110 transition-transform",children:[a.liveCount??0,"/",a.max_members??8]})]}),(0,b.jsx)("h4",{className:"text-lg sm:text-xl font-bold mb-1 text-balance group-hover:text-primary transition-colors",children:a.name}),(0,b.jsx)("p",{className:"text-xs sm:text-sm text-foreground/60 mb-2 sm:mb-3",children:a.topic}),a.creator&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[(0,b.jsx)("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full border-2 border-background overflow-hidden bg-primary/20 flex items-center justify-center",children:a.creator.avatar_url?(0,b.jsx)("img",{src:a.creator.avatar_url,alt:a.creator.display_name||a.creator.username,className:"w-full h-full object-cover"}):(0,b.jsx)("span",{className:"text-xs font-semibold text-foreground/70",children:(a.creator.display_name||a.creator.username||"?").charAt(0).toUpperCase()})}),(0,b.jsxs)("span",{className:"text-xs sm:text-sm text-foreground/70",children:["Admin ",a.creator.display_name||a.creator.username]})]}),a.members&&a.members.length>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[(0,b.jsx)("div",{className:"flex -space-x-2 overflow-x-auto max-w-full pr-1",children:a.members.slice(0,8).map((a,c)=>(0,b.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 border-background overflow-hidden bg-accent/20 flex items-center justify-center",title:a.display_name||a.username,children:a.avatar_url?(0,b.jsx)("img",{src:a.avatar_url,alt:a.display_name||a.username,className:"w-full h-full object-cover"}):(0,b.jsx)("span",{className:"text-xs sm:text-sm font-semibold text-foreground/70",children:(a.display_name||a.username||"?").charAt(0).toUpperCase()})},a.id||c))}),(a.liveCount??a.member_count??0)>8&&(0,b.jsxs)("span",{className:"text-xs sm:text-sm text-foreground/60",children:["+",(a.liveCount??a.member_count??0)-8," more"]})]}),(0,b.jsx)(d.Button,{size:"sm",className:"w-full bg-primary hover:bg-primary/90 rounded-full text-xs sm:text-sm",onClick:b=>{b.preventDefault(),b.stopPropagation(),L.push(`/room/${a.id}`)},children:(a.max_members??8)-(a.liveCount??0)<=0?"Full â€“ View":"Join Now"})]},a.id))})]})}),(0,b.jsx)("section",{className:"py-12 md:py-20 bg-primary/5 dark:bg-primary/10 border-t border-border hidden md:block",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,b.jsx)("h3",{className:"text-3xl md:text-4xl font-bold mb-12 text-center",children:"Why ChatBloom?"}),(0,b.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{icon:j.MessageCircle,title:"Group Chats",desc:"Chat with thousands in public rooms"},{icon:g.Heart,title:"Reactions",desc:"React with stickers, emojis & GIFs"},{icon:h.Users,title:"Direct Messages",desc:"1-on-1 conversations with friends"},{icon:i.Sparkles,title:"Rewards",desc:"Earn XP, badges & level up"}].map((a,c)=>(0,b.jsxs)("div",{className:"bg-card rounded-2xl p-6 hover:shadow-lg transition-shadow",children:[(0,b.jsx)(a.icon,{className:"w-8 h-8 text-primary mb-4"}),(0,b.jsx)("h4",{className:"font-bold text-lg mb-2",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-foreground/60",children:a.desc})]},c))})]})}),(0,b.jsx)("section",{className:"py-12 md:py-20 hidden md:block",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,b.jsxs)("div",{className:"bg-gradient-to-br from-primary to-accent rounded-3xl p-6 md:p-12 text-center text-white",children:[(0,b.jsx)("h3",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Ready to Join the Conversation?"}),(0,b.jsx)("p",{className:"text-lg opacity-90 mb-8",children:"Start chatting now, no credit card required"}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,b.jsx)(o.default,{href:"/auth",children:(0,b.jsx)(d.Button,{size:"lg",variant:"secondary",className:"rounded-full font-semibold px-8",children:"Create an Account"})}),(0,b.jsx)(o.default,{href:"/auth",children:(0,b.jsx)(d.Button,{size:"lg",variant:"outline",className:"rounded-full font-semibold px-8 text-white border-white hover:bg-white/10",children:"Sign In"})})]})]})})})]})}a.s(["default",()=>r],60350)}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map